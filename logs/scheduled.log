2016-12-15 15:59:47.408 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=config.properties
2016-12-15 15:59:47.604 [main] INFO  cn.shiyanjun.platform.scheduled.ScheduledMain - Platform ID: 5d54f2f494964c35a81e4422678141a0
2016-12-15 15:59:47.619 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=redis.properties
2016-12-15 15:59:47.711 [main] INFO  cn.shiyanjun.platform.scheduled.utils.ResourceUtils - Resource registered: config=redis.properties, resource=redis.clients.jedis.JedisPool@383534aa
2016-12-15 15:59:48.514 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-15 15:59:48.657 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured task types: {q_user_job=[GREEN_PLUM, JAVA_APPLICATION], q_enterprise_job=[GREEN_PLUM, JAVA_APPLICATION]}
2016-12-15 15:59:48.658 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured resources: {q_user_job={GREEN_PLUM=1, JAVA_APPLICATION=1}, q_enterprise_job={GREEN_PLUM=0, JAVA_APPLICATION=0}}
2016-12-15 15:59:48.675 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Configs: fetchJobInterval=3000, initialDelay=5000
2016-12-15 15:59:48.709 [main] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Configs: jobOrchestrateServiceUrl=http://localhost:8080/job/orchestrate
2016-12-15 15:59:48.710 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Protocol: jobOrchestrationProtocol=REST
2016-12-15 15:59:48.714 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Protocol: jobFetchProtocol=MYSQL
2016-12-15 15:59:48.759 [main] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Configs: isRecoveryFeatureEnabled=false
2016-12-15 15:59:48.759 [main] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Configs: keptHistoryJobMaxCount=200
2016-12-15 15:59:48.940 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/resource, servletClazz=cn.shiyanjun.platform.scheduled.rest.ResourceServlet
2016-12-15 15:59:48.948 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/queueing, servletClazz=cn.shiyanjun.platform.scheduled.rest.QueueingServlet
2016-12-15 15:59:48.950 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/scheduling, servletClazz=cn.shiyanjun.platform.scheduled.rest.SchedulingServlet
2016-12-15 15:59:48.950 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=queueings.properties
2016-12-15 15:59:49.104 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Start to read messages from MQ ...
2016-12-15 15:59:49.106 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Complete to read MQ messages: q=/scheduled/mq_heartbeat
2016-12-15 15:59:49.161 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Completed jobs: []
2016-12-15 15:59:49.166 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Pending recovery status: jobCount=0, jobs={}
2016-12-15 15:59:49.180 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Fetch job pool started: java.util.concurrent.Executors$DelegatedScheduledExecutorService@48fa0f47
2016-12-15 15:59:49.662 [SCHEDULED-003] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRunnableConsumer - Consumer started: consumerTag=amq.ctag-YAKXgyvCaC20hCwY73rDRg
2016-12-15 15:59:49.672 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/resource, servlet=cn.shiyanjun.platform.scheduled.rest.ResourceServlet@c8c12ac
2016-12-15 15:59:49.680 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/scheduling, servlet=cn.shiyanjun.platform.scheduled.rest.SchedulingServlet@55183b20
2016-12-15 15:59:49.680 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/queueing, servlet=cn.shiyanjun.platform.scheduled.rest.QueueingServlet@6cf0e0ba
2016-12-15 16:00:03.189 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Fetch jobs: count=1
2016-12-15 16:00:03.240 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Job fetched: jobId=1, fromStatus=SUBMITTED, toStatus=FETCHED
2016-12-15 16:00:03.240 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Job info: id=1, params={"conditions":[{"expType":"uploadFilter","exps":[{"inputId":"41","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705","expCode":"01000"}]},{"expType":"locationFilter","exps":[{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"},{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"},{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"}]},{"expType":"outputChart","exps":[{"city":"北京市","coordinateType":"1","endTime":"2016-41","startTime":"2016-41","timeType":"2","expCode":"04000"}]}],"excludeCheatedIds":0,"name":"test","outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output","outputType":3,"projectId":47}
2016-12-15 16:00:03.260 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Prepare to request job orchestrate service: Request{method=POST, url=http://localhost:8080/job/orchestrate/1/1, tag=null}
2016-12-15 16:00:04.250 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Responsed orchestrated job: {
	"jobId":1,
	"jobType":1,
	"stages":[
		{
			"stageLevel":0,
			"stageName":"FilterJobStage-0",
			"tasks":[
				{
					"expCode":"01000",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"上传设备ID条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/id?inputId=41&inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705&idRelationName=f60fee6111c94af6b8651f8b63678b33&outputBitmapKey=c1320ce66c414c3292f7b33edb8de6dc\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputId\":\"41\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705\"}],\"expType\":\"uploadFilter\",\"expCode\":\"01000\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":1,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":1,
			"stageName":"FilterJobStage-1",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=7040f3c292d04613998cbd922f826100\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":2,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":2,
			"stageName":"FilterJobStage-2",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=84f91f2cb53740df856a1897b7320962\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":3,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":3,
			"stageName":"FilterJobStage-3",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=010112ea094f45b2bb6161fc09e5876a\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":4,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":4,
			"stageName":"MergeJobStage-4",
			"tasks":[
				{
					"expCode":"00000",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"中间结果合并筛选\",\"taskType\":\"1\",\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/calculate/bitmap?bitmapExp=c1320ce66c414c3292f7b33edb8de6dcAND7040f3c292d04613998cbd922f826100AND84f91f2cb53740df856a1897b7320962AND010112ea094f45b2bb6161fc09e5876a&excludeCheatedIds=0&outputBitmapKey=836853a0ced34a8cb7e7a4e0f8b1a4c0\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"expCode\":\"00000\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":5,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":5,
			"stageName":"OutputJobStage-5",
			"tasks":[
				{
					"expCode":"04000",
					"jobId":1,
					"outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate",
					"parsedExpression":"{\"taskDesc\":\"输出聚集点明细\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/match/coordinate?inputBitmapKey=836853a0ced34a8cb7e7a4e0f8b1a4c0&outputPath=/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate&idRelationName=f60fee6111c94af6b8651f8b63678b33&coordinateType=1&timeType=2&startTime=2016-41&endTime=2016-41\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"city\":\"北京市\",\"coordinateType\":\"1\",\"timeType\":\"2\",\"startTime\":\"2016-41\",\"endTime\":\"2016-41\"}],\"expType\":\"outputChart\",\"expCode\":\"04000\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":6,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":6,
			"stageName":"OutputJobStage-6",
			"tasks":[
				{
					"expCode":"00002",
					"inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate",
					"jobId":1,
					"outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap",
					"parsedExpression":"{\"taskDesc\":\"生成热力图数据\",\"hasIdMatch\":true,\"taskType\":2,\"handlerClass\":\"cn.shiyanjun.ddc.handler.HotMapTaskHander\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"city\":\"北京市\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":7,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.HotMapTaskHander",
					"taskType":2
				}
			]
		}
	]
}
2016-12-15 16:00:04.486 [QUEUEING-WORKER] INFO  cn.shiyanjun.platform.scheduled.component.QueueingManagerImpl - Job queued: {"jobId":1,"jobStatus":"QUEUEING","taskCount":7,"taskId":-1,"serialNo":-1,"taskStatus":"WAIT_TO_BE_SCHEDULED","lastUpdateTs":1481788804458}
2016-12-15 16:00:04.705 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481788804686,"taskId":1,"taskStatus":"SCHEDULED","serialNo":1}
2016-12-15 16:00:04.705 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481788804686,"taskId":1,"taskStatus":"SCHEDULED","serialNo":1}
2016-12-15 16:00:04.706 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:00:04.706 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:00:04.708 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=1/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:00:04.708 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:00:04.708 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:00:04.710 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=q_user_job, taskType=GREEN_PLUM,  jobId=1, taskId=1, serialNo=1, taskType=Optional[GREEN_PLUM], taskCount=7
2016-12-15 16:00:04.719 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2016-12-15 16:00:04.713, jobStatus=SCHEDULED
2016-12-15 16:00:04.725 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=1, serialNo=1, taskStatus=SCHEDULED
2016-12-15 16:00:04.729 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory job state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481788804727}
2016-12-15 16:00:04.730 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481788804727}, task={"jobId":1,"taskId":1,"serialNo":1,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SCHEDULED","lastUpdateTs":1481788804727}
2016-12-15 16:00:04.733 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":1,"role":1,"serialNo":1,"taskCount":7,"params":"{\"taskDesc\":\"上传设备ID条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/id?inputId=41&inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705&idRelationName=f60fee6111c94af6b8651f8b63678b33&outputBitmapKey=c1320ce66c414c3292f7b33edb8de6dc\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputId\":\"41\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705\"}],\"expType\":\"uploadFilter\",\"expCode\":\"01000\"}"}
2016-12-15 16:00:04.739 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804734,"taskId":1,"taskStatus":"RUNNING","serialNo":1}
2016-12-15 16:00:04.745 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2016-12-15 16:00:04.74, jobStatus=RUNNING
2016-12-15 16:00:04.749 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=1, serialNo=1, startTime=2016-12-15 16:00:04.745, updateTime=2016-12-15 16:00:04.745, taskStatus=RUNNING
2016-12-15 16:00:04.749 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory job state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}
2016-12-15 16:00:04.749 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":1,"serialNo":1,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481788804749}
2016-12-15 16:00:04.758 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=0, failedCount=0, runningTaskCount=1
2016-12-15 16:03:31.220 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-15 16:03:31.589 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":1,"taskType":1,"serialNo":1,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:03:31.599 [pool-1-thread-10] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=1, message={"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":1,"taskType":1,"serialNo":1,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:03:31.604 [pool-1-thread-10] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=1, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":1,"serialNo":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:03:31.604 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=1, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":1,"serialNo":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:03:31.605 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":1,"serialNo":1,"status":"SUCCEEDED"}]}
2016-12-15 16:03:31.605 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=1, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":1,"serialNo":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:03:31.606 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":1,"serialNo":1,"status":"SUCCEEDED"}
2016-12-15 16:03:31.606 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":1,"serialNo":1,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481788804749}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}
2016-12-15 16:03:31.609 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":1,"serialNo":1,"status":"SUCCEEDED"}
2016-12-15 16:03:31.609 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:03:31.610 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:03:31.610 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:03:31.610 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:03:31.611 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:03:31.611 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=0, failedCount=0, runningTaskCount=0
2016-12-15 16:03:31.617 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=1, serialNo=1, resultCount=1423, updateTime=2016-12-15 16:03:31.611, taskStatus=SUCCEEDED
2016-12-15 16:03:31.624 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2016-12-15 16:03:31.62
2016-12-15 16:03:31.627 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","lastUpdateTs":1481789011624,"taskId":1,"taskStatus":"SUCCEEDED","serialNo":1}
2016-12-15 16:03:31.628 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":1,"serialNo":1,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SUCCEEDED","lastUpdateTs":1481789011620}
2016-12-15 16:03:31.628 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=1, failedCount=0, runningTaskCount=0
2016-12-15 16:03:34.944 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481789014941,"taskId":2,"taskStatus":"SCHEDULED","serialNo":2}
2016-12-15 16:03:34.944 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481789014941,"taskId":2,"taskStatus":"SCHEDULED","serialNo":2}
2016-12-15 16:03:34.945 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:03:34.945 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:03:34.945 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=1/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:03:34.945 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:03:34.945 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:03:34.945 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=q_user_job, taskType=GREEN_PLUM,  jobId=1, taskId=2, serialNo=2, taskType=Optional[GREEN_PLUM], taskCount=7
2016-12-15 16:03:34.952 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=2, serialNo=2, taskStatus=SCHEDULED
2016-12-15 16:03:34.952 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":2,"serialNo":2,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SCHEDULED","lastUpdateTs":1481789014952}
2016-12-15 16:03:34.952 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":2,"role":1,"serialNo":2,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=7040f3c292d04613998cbd922f826100\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2016-12-15 16:03:34.956 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481789014952,"taskId":2,"taskStatus":"RUNNING","serialNo":2}
2016-12-15 16:03:34.962 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=2, serialNo=2, startTime=2016-12-15 16:03:34.956, updateTime=2016-12-15 16:03:34.956, taskStatus=RUNNING
2016-12-15 16:03:34.963 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":2,"serialNo":2,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789014963}
2016-12-15 16:03:34.963 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=1, failedCount=0, runningTaskCount=1
2016-12-15 16:03:58.975 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-15 16:03:59.503 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":2,"taskType":1,"serialNo":2,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:03:59.505 [pool-1-thread-11] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=2, message={"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":2,"taskType":1,"serialNo":2,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:03:59.506 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=2, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":2,"serialNo":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:03:59.507 [pool-1-thread-11] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=2, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":2,"serialNo":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:03:59.507 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":2,"serialNo":2,"status":"SUCCEEDED"}]}
2016-12-15 16:03:59.508 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=2, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":2,"serialNo":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:03:59.508 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":2,"serialNo":2,"status":"SUCCEEDED"}
2016-12-15 16:03:59.509 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":2,"serialNo":2,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789014963}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}
2016-12-15 16:03:59.509 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":2,"serialNo":2,"status":"SUCCEEDED"}
2016-12-15 16:03:59.510 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:03:59.510 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:03:59.510 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:03:59.510 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:03:59.510 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:03:59.511 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=1, failedCount=0, runningTaskCount=0
2016-12-15 16:03:59.517 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=2, serialNo=2, resultCount=1423, updateTime=2016-12-15 16:03:59.511, taskStatus=SUCCEEDED
2016-12-15 16:03:59.524 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2016-12-15 16:03:59.521
2016-12-15 16:03:59.528 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","lastUpdateTs":1481789039524,"taskId":2,"taskStatus":"SUCCEEDED","serialNo":2}
2016-12-15 16:03:59.528 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":2,"serialNo":2,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SUCCEEDED","lastUpdateTs":1481789039521}
2016-12-15 16:03:59.528 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=2, failedCount=0, runningTaskCount=0
2016-12-15 16:03:59.992 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481789039988,"taskId":3,"taskStatus":"SCHEDULED","serialNo":3}
2016-12-15 16:03:59.992 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481789039988,"taskId":3,"taskStatus":"SCHEDULED","serialNo":3}
2016-12-15 16:03:59.992 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:03:59.992 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:03:59.992 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=1/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:03:59.992 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:03:59.992 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:03:59.993 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=q_user_job, taskType=GREEN_PLUM,  jobId=1, taskId=3, serialNo=3, taskType=Optional[GREEN_PLUM], taskCount=7
2016-12-15 16:03:59.999 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=3, serialNo=3, taskStatus=SCHEDULED
2016-12-15 16:04:00.000 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":3,"serialNo":3,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SCHEDULED","lastUpdateTs":1481789040000}
2016-12-15 16:04:00.001 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":3,"role":1,"serialNo":3,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=84f91f2cb53740df856a1897b7320962\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2016-12-15 16:04:00.006 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481789040001,"taskId":3,"taskStatus":"RUNNING","serialNo":3}
2016-12-15 16:04:00.012 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=3, serialNo=3, startTime=2016-12-15 16:04:00.006, updateTime=2016-12-15 16:04:00.006, taskStatus=RUNNING
2016-12-15 16:04:00.013 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":3,"serialNo":3,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789040013}
2016-12-15 16:04:00.013 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=2, failedCount=0, runningTaskCount=1
2016-12-15 16:04:22.511 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-15 16:04:22.845 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":3,"taskType":1,"serialNo":3,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:04:22.847 [pool-1-thread-12] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=3, message={"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":3,"taskType":1,"serialNo":3,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:04:22.849 [pool-1-thread-12] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=3, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":3,"serialNo":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:04:22.850 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=3, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":3,"serialNo":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:04:22.850 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":3,"serialNo":3,"status":"SUCCEEDED"}]}
2016-12-15 16:04:22.851 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=3, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":3,"serialNo":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:04:22.852 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":3,"serialNo":3,"status":"SUCCEEDED"}
2016-12-15 16:04:22.852 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":3,"serialNo":3,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789040013}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}
2016-12-15 16:04:22.853 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":3,"serialNo":3,"status":"SUCCEEDED"}
2016-12-15 16:04:22.853 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:04:22.853 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:04:22.854 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:04:22.854 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:04:22.854 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:04:22.854 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=2, failedCount=0, runningTaskCount=0
2016-12-15 16:04:22.862 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=3, serialNo=3, resultCount=1423, updateTime=2016-12-15 16:04:22.854, taskStatus=SUCCEEDED
2016-12-15 16:04:22.870 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2016-12-15 16:04:22.865
2016-12-15 16:04:22.873 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","lastUpdateTs":1481789062870,"taskId":3,"taskStatus":"SUCCEEDED","serialNo":3}
2016-12-15 16:04:22.873 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":3,"serialNo":3,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SUCCEEDED","lastUpdateTs":1481789062865}
2016-12-15 16:04:22.874 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=3, failedCount=0, runningTaskCount=0
2016-12-15 16:04:25.045 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481789065042,"taskId":4,"taskStatus":"SCHEDULED","serialNo":4}
2016-12-15 16:04:25.045 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481789065042,"taskId":4,"taskStatus":"SCHEDULED","serialNo":4}
2016-12-15 16:04:25.046 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:04:25.046 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:04:25.046 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=1/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:04:25.046 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:04:25.046 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:04:25.046 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=q_user_job, taskType=GREEN_PLUM,  jobId=1, taskId=4, serialNo=4, taskType=Optional[GREEN_PLUM], taskCount=7
2016-12-15 16:04:25.052 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=4, serialNo=4, taskStatus=SCHEDULED
2016-12-15 16:04:25.052 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":4,"serialNo":4,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SCHEDULED","lastUpdateTs":1481789065052}
2016-12-15 16:04:25.053 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":4,"role":1,"serialNo":4,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=010112ea094f45b2bb6161fc09e5876a\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2016-12-15 16:04:25.056 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481789065053,"taskId":4,"taskStatus":"RUNNING","serialNo":4}
2016-12-15 16:04:25.060 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=4, serialNo=4, startTime=2016-12-15 16:04:25.057, updateTime=2016-12-15 16:04:25.057, taskStatus=RUNNING
2016-12-15 16:04:25.060 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":4,"serialNo":4,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789065060}
2016-12-15 16:04:25.061 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=3, failedCount=0, runningTaskCount=1
2016-12-15 16:04:36.260 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-15 16:04:36.605 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":4,"taskType":1,"serialNo":4,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:04:36.606 [pool-1-thread-13] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=4, message={"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":4,"taskType":1,"serialNo":4,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:04:36.607 [pool-1-thread-13] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=4, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":4,"serialNo":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:04:36.607 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=4, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":4,"serialNo":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:04:36.608 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":4,"serialNo":4,"status":"SUCCEEDED"}]}
2016-12-15 16:04:36.608 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=4, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":4,"serialNo":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:04:36.609 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":4,"serialNo":4,"status":"SUCCEEDED"}
2016-12-15 16:04:36.610 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":4,"serialNo":4,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789065060}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}
2016-12-15 16:04:36.610 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":4,"serialNo":4,"status":"SUCCEEDED"}
2016-12-15 16:04:36.610 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:04:36.611 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:04:36.611 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:04:36.611 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:04:36.611 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:04:36.611 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=3, failedCount=0, runningTaskCount=0
2016-12-15 16:04:36.617 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=4, serialNo=4, resultCount=1423, updateTime=2016-12-15 16:04:36.611, taskStatus=SUCCEEDED
2016-12-15 16:04:36.627 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2016-12-15 16:04:36.62
2016-12-15 16:04:36.631 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","lastUpdateTs":1481789076627,"taskId":4,"taskStatus":"SUCCEEDED","serialNo":4}
2016-12-15 16:04:36.632 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":4,"serialNo":4,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SUCCEEDED","lastUpdateTs":1481789076620}
2016-12-15 16:04:36.632 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=4, failedCount=0, runningTaskCount=0
2016-12-15 16:04:40.109 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481789080088,"taskId":5,"taskStatus":"SCHEDULED","serialNo":5}
2016-12-15 16:04:40.109 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481789080088,"taskId":5,"taskStatus":"SCHEDULED","serialNo":5}
2016-12-15 16:04:40.110 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:04:40.110 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:04:40.111 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=1/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:04:40.111 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:04:40.111 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:04:40.112 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=q_user_job, taskType=GREEN_PLUM,  jobId=1, taskId=5, serialNo=5, taskType=Optional[GREEN_PLUM], taskCount=7
2016-12-15 16:04:40.130 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=5, serialNo=5, taskStatus=SCHEDULED
2016-12-15 16:04:40.131 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":5,"serialNo":5,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SCHEDULED","lastUpdateTs":1481789080131}
2016-12-15 16:04:40.134 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":5,"role":1,"serialNo":5,"taskCount":7,"params":"{\"taskDesc\":\"中间结果合并筛选\",\"taskType\":\"1\",\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/calculate/bitmap?bitmapExp=c1320ce66c414c3292f7b33edb8de6dcAND7040f3c292d04613998cbd922f826100AND84f91f2cb53740df856a1897b7320962AND010112ea094f45b2bb6161fc09e5876a&excludeCheatedIds=0&outputBitmapKey=836853a0ced34a8cb7e7a4e0f8b1a4c0\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"expCode\":\"00000\"}"}
2016-12-15 16:04:40.158 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481789080134,"taskId":5,"taskStatus":"RUNNING","serialNo":5}
2016-12-15 16:04:40.167 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=5, serialNo=5, startTime=2016-12-15 16:04:40.159, updateTime=2016-12-15 16:04:40.159, taskStatus=RUNNING
2016-12-15 16:04:40.167 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":5,"serialNo":5,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789080167}
2016-12-15 16:04:40.168 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=4, failedCount=0, runningTaskCount=1
2016-12-15 16:04:51.698 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-15 16:04:51.997 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":5,"taskType":1,"serialNo":5,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:04:51.998 [pool-1-thread-14] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=5, message={"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":5,"taskType":1,"serialNo":5,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:04:51.999 [pool-1-thread-14] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=5, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":5,"serialNo":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:04:52.002 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=5, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":5,"serialNo":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:04:52.002 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":5,"serialNo":5,"status":"SUCCEEDED"}]}
2016-12-15 16:04:52.003 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=5, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":5,"serialNo":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:04:52.003 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":5,"serialNo":5,"status":"SUCCEEDED"}
2016-12-15 16:04:52.004 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":5,"serialNo":5,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789080167}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}
2016-12-15 16:04:52.006 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":5,"serialNo":5,"status":"SUCCEEDED"}
2016-12-15 16:04:52.006 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:04:52.007 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:04:52.007 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:04:52.007 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:04:52.008 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:04:52.008 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=4, failedCount=0, runningTaskCount=0
2016-12-15 16:04:52.012 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=5, serialNo=5, resultCount=1423, updateTime=2016-12-15 16:04:52.008, taskStatus=SUCCEEDED
2016-12-15 16:04:52.018 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2016-12-15 16:04:52.014
2016-12-15 16:04:52.022 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","lastUpdateTs":1481789092018,"taskId":5,"taskStatus":"SUCCEEDED","serialNo":5}
2016-12-15 16:04:52.022 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":5,"serialNo":5,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SUCCEEDED","lastUpdateTs":1481789092014}
2016-12-15 16:04:52.023 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=5, failedCount=0, runningTaskCount=0
2016-12-15 16:04:55.192 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481789095188,"taskId":6,"taskStatus":"SCHEDULED","serialNo":6}
2016-12-15 16:04:55.193 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481789095188,"taskId":6,"taskStatus":"SCHEDULED","serialNo":6}
2016-12-15 16:04:55.193 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:04:55.193 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:04:55.193 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=1/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:04:55.193 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:04:55.193 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:04:55.193 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=q_user_job, taskType=GREEN_PLUM,  jobId=1, taskId=6, serialNo=6, taskType=Optional[GREEN_PLUM], taskCount=7
2016-12-15 16:04:55.199 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=6, serialNo=6, taskStatus=SCHEDULED
2016-12-15 16:04:55.199 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":6,"serialNo":6,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SCHEDULED","lastUpdateTs":1481789095199}
2016-12-15 16:04:55.200 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":6,"role":1,"serialNo":6,"taskCount":7,"params":"{\"taskDesc\":\"输出聚集点明细\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/match/coordinate?inputBitmapKey=836853a0ced34a8cb7e7a4e0f8b1a4c0&outputPath=/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate&idRelationName=f60fee6111c94af6b8651f8b63678b33&coordinateType=1&timeType=2&startTime=2016-41&endTime=2016-41\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"city\":\"北京市\",\"coordinateType\":\"1\",\"timeType\":\"2\",\"startTime\":\"2016-41\",\"endTime\":\"2016-41\"}],\"expType\":\"outputChart\",\"expCode\":\"04000\"}"}
2016-12-15 16:04:55.202 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481789095200,"taskId":6,"taskStatus":"RUNNING","serialNo":6}
2016-12-15 16:04:55.205 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=6, serialNo=6, startTime=2016-12-15 16:04:55.202, updateTime=2016-12-15 16:04:55.202, taskStatus=RUNNING
2016-12-15 16:04:55.205 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":6,"serialNo":6,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789095205}
2016-12-15 16:04:55.206 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=5, failedCount=0, runningTaskCount=1
2016-12-15 16:05:07.983 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-15 16:05:08.282 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":6,"taskType":1,"serialNo":6,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:05:08.283 [pool-1-thread-15] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=6, message={"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":6,"taskType":1,"serialNo":6,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:05:08.284 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=6, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":6,"serialNo":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:05:08.284 [pool-1-thread-15] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=6, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":6,"serialNo":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:05:08.284 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":6,"serialNo":6,"status":"SUCCEEDED"}]}
2016-12-15 16:05:08.284 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=6, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":6,"serialNo":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:05:08.284 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":6,"serialNo":6,"status":"SUCCEEDED"}
2016-12-15 16:05:08.284 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":6,"serialNo":6,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789095205}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}
2016-12-15 16:05:08.284 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":6,"serialNo":6,"status":"SUCCEEDED"}
2016-12-15 16:05:08.284 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:05:08.284 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:05:08.285 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:05:08.286 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:05:08.286 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:05:08.287 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=5, failedCount=0, runningTaskCount=0
2016-12-15 16:05:08.291 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=6, serialNo=6, resultCount=1423, updateTime=2016-12-15 16:05:08.287, taskStatus=SUCCEEDED
2016-12-15 16:05:08.296 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2016-12-15 16:05:08.293
2016-12-15 16:05:08.300 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","lastUpdateTs":1481789108296,"taskId":6,"taskStatus":"SUCCEEDED","serialNo":6}
2016-12-15 16:05:08.301 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":6,"serialNo":6,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SUCCEEDED","lastUpdateTs":1481789108293}
2016-12-15 16:05:08.301 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=6, failedCount=0, runningTaskCount=0
2016-12-15 16:05:10.250 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481789110247,"taskId":7,"taskStatus":"SCHEDULED","serialNo":7}
2016-12-15 16:05:10.250 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481789110247,"taskId":7,"taskStatus":"SCHEDULED","serialNo":7}
2016-12-15 16:05:10.250 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:05:10.250 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:05:10.250 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=1/1) 
2016-12-15 16:05:10.250 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:05:10.250 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:05:10.251 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=q_user_job, taskType=JAVA_APPLICATION,  jobId=1, taskId=7, serialNo=7, taskType=Optional[JAVA_APPLICATION], taskCount=7
2016-12-15 16:05:10.258 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=7, serialNo=7, taskStatus=SCHEDULED
2016-12-15 16:05:10.259 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":7,"serialNo":7,"taskType":"JAVA_APPLICATION","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SCHEDULED","lastUpdateTs":1481789110258}
2016-12-15 16:05:10.259 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":7,"role":2,"serialNo":7,"taskCount":7,"params":"{\"taskDesc\":\"生成热力图数据\",\"hasIdMatch\":true,\"taskType\":2,\"handlerClass\":\"cn.shiyanjun.ddc.handler.HotMapTaskHander\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"city\":\"北京市\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap\"}"}
2016-12-15 16:05:10.261 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481789110259,"taskId":7,"taskStatus":"RUNNING","serialNo":7}
2016-12-15 16:05:10.267 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=7, serialNo=7, startTime=2016-12-15 16:05:10.262, updateTime=2016-12-15 16:05:10.262, taskStatus=RUNNING
2016-12-15 16:05:10.267 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}, task={"jobId":1,"taskId":7,"serialNo":7,"taskType":"JAVA_APPLICATION","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789110267}
2016-12-15 16:05:10.267 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=6, failedCount=0, runningTaskCount=1
2016-12-15 16:05:25.903 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-15 16:05:26.224 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":7,"taskType":2,"serialNo":7,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:05:26.226 [pool-1-thread-16] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=7, message={"type":"taskProgress","platform_id":"5d54f2f494964c35a81e4422678141a0","tasks":[{"jobId":1,"taskId":7,"taskType":2,"serialNo":7,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-15 16:05:26.226 [pool-1-thread-16] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=7, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","taskId":7,"serialNo":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:05:26.226 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=7, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","taskId":7,"serialNo":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:05:26.227 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","taskId":7,"serialNo":7,"status":"SUCCEEDED"}]}
2016-12-15 16:05:26.227 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=7, heartbeatMessage={"platform_id":"5d54f2f494964c35a81e4422678141a0","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","taskId":7,"serialNo":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-15 16:05:26.227 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":2,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":7,"serialNo":7,"status":"SUCCEEDED"}
2016-12-15 16:05:26.228 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":7,"serialNo":7,"taskType":"JAVA_APPLICATION","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789110267}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481788804749}
2016-12-15 16:05:26.228 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":2,"resultCount":"1423","platform_id":"5d54f2f494964c35a81e4422678141a0","taskId":7,"serialNo":7,"status":"SUCCEEDED"}
2016-12-15 16:05:26.229 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:05:26.229 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2016-12-15 16:05:26.229 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_user_job: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2016-12-15 16:05:26.229 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=q_enterprise_job: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2016-12-15 16:05:26.229 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2016-12-15 16:05:26.230 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=6, failedCount=0, runningTaskCount=0
2016-12-15 16:05:26.235 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=7, serialNo=7, resultCount=1423, updateTime=2016-12-15 16:05:26.23, taskStatus=SUCCEEDED
2016-12-15 16:05:26.243 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2016-12-15 16:05:26.237, jobStatus=SUCCEEDED
2016-12-15 16:05:26.244 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory job state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SUCCEEDED","lastUpdateTs":1481789126243}
2016-12-15 16:05:26.244 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Moving in-mem job: runningJobIdToInfos -> completedJobIdToInfos
2016-12-15 16:05:26.247 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":1,"serialNo":1,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SUCCEEDED","lastUpdateTs":1481789011620}
2016-12-15 16:05:26.247 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":2,"serialNo":2,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SUCCEEDED","lastUpdateTs":1481789039521}
2016-12-15 16:05:26.247 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":3,"serialNo":3,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SUCCEEDED","lastUpdateTs":1481789062865}
2016-12-15 16:05:26.247 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":4,"serialNo":4,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SUCCEEDED","lastUpdateTs":1481789076620}
2016-12-15 16:05:26.247 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":5,"serialNo":5,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SUCCEEDED","lastUpdateTs":1481789092014}
2016-12-15 16:05:26.247 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":6,"serialNo":6,"taskType":"GREEN_PLUM","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"SUCCEEDED","lastUpdateTs":1481789108293}
2016-12-15 16:05:26.248 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":7,"serialNo":7,"taskType":"JAVA_APPLICATION","platform_id":"5d54f2f494964c35a81e4422678141a0","taskStatus":"RUNNING","lastUpdateTs":1481789110267}
2016-12-15 16:05:26.248 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem job moved: {"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SUCCEEDED","lastUpdateTs":1481789126243}
2016-12-15 16:05:26.248 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=q_user_job, succeededCount=7, failedCount=0, runningTaskCount=0
2016-12-15 16:08:27.225 [qtp1032000752-36] INFO  cn.shiyanjun.platform.scheduled.rest.ResourceServlet - Requested params: {"queue":"q_user_job","taskType":"1","amount":"2"}
2016-12-15 16:08:27.225 [qtp1032000752-36] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Resource updated via REST: queue=q_user_job, taskTypeGREEN_PLUM, oldAmount=1, newAmount=2, occupied=0
2016-12-15 16:09:35.693 [qtp1032000752-36] INFO  cn.shiyanjun.platform.scheduled.rest.ResourceServlet - Requested params: {"queue":"q_user_job","taskType":"1","amount":"1"}
2016-12-15 16:09:35.693 [qtp1032000752-36] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Resource updated via REST: queue=q_user_job, taskTypeGREEN_PLUM, oldAmount=2, newAmount=1, occupied=0
