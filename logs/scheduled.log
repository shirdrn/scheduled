2017-02-18 17:27:48.266 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=config.properties
2017-02-18 17:27:48.457 [main] INFO  cn.shiyanjun.platform.scheduled.ScheduledMain - Platform ID: 01683c548bc74e7c8d4e78020f4c68c8
2017-02-18 17:27:48.472 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=redis.properties
2017-02-18 17:27:48.551 [main] INFO  cn.shiyanjun.platform.scheduled.utils.ResourceUtils - Resource registered: config=redis.properties, resource=redis.clients.jedis.JedisPool@161cd475
2017-02-18 17:27:48.952 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2017-02-18 17:27:48.976 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configs: maxRecycleResourceCacheCapacity=10000
2017-02-18 17:27:49.015 [main] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Configs: keptHistoryJobMaxCount=200
2017-02-18 17:27:49.016 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Configs: fetchJobInterval=3000, initialDelay=5000
2017-02-18 17:27:49.016 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Configs: maintenanceSegmentStartTime=03:00:00, maintenanceSegmentEndTime=03:15:00
2017-02-18 17:27:49.032 [main] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Configs: jobOrchestrateServiceUrl=http://127.0.0.1:8080/job/orchestrate
2017-02-18 17:27:49.033 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Protocol: jobOrchestrationProtocol=REST
2017-02-18 17:27:49.034 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Protocol: jobFetchProtocol=MYSQL
2017-02-18 17:27:49.199 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/resource, servletClazz=cn.shiyanjun.platform.scheduled.rest.ResourceServlet
2017-02-18 17:27:49.200 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/queueing, servletClazz=cn.shiyanjun.platform.scheduled.rest.QueueingServlet
2017-02-18 17:27:49.201 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/scheduling, servletClazz=cn.shiyanjun.platform.scheduled.rest.SchedulingServlet
2017-02-18 17:27:49.202 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/maintenance, servletClazz=cn.shiyanjun.platform.scheduled.rest.MaintenanceServlet
2017-02-18 17:27:49.202 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/cancelJob, servletClazz=cn.shiyanjun.platform.scheduled.rest.CancelJobServlet
2017-02-18 17:27:49.203 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=queueings.properties
2017-02-18 17:27:49.224 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured task types: {user_job_queue=[JAVA_APPLICATION, GREEN_PLUM]}
2017-02-18 17:27:49.225 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured resources: {user_job_queue={JAVA_APPLICATION=1, GREEN_PLUM=1}}
2017-02-18 17:27:49.226 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured task types: {enterprise_job_queue=[JAVA_APPLICATION, GREEN_PLUM], user_job_queue=[JAVA_APPLICATION, GREEN_PLUM]}
2017-02-18 17:27:49.226 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured resources: {enterprise_job_queue={JAVA_APPLICATION=0, GREEN_PLUM=0}, user_job_queue={JAVA_APPLICATION=1, GREEN_PLUM=1}}
2017-02-18 17:27:49.310 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Start to read messages from MQ ...
2017-02-18 17:27:49.311 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Complete to read MQ messages: q=/scheduled/mq_heartbeat
2017-02-18 17:27:49.347 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Completed jobs: []
2017-02-18 17:27:49.349 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Pending recovery status: jobCount=0, jobs={}
2017-02-18 17:27:49.356 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Fetch job pool started: java.util.concurrent.Executors$DelegatedScheduledExecutorService@4f209819
2017-02-18 17:27:49.359 [main] INFO  cn.shiyanjun.platform.scheduled.component.SimpleTaskResponseHandlingController - Configs: isRecoveryFeatureEnabled=false
2017-02-18 17:27:49.699 [SCHEDULED-003] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRunnableConsumer - Consumer started: consumerTag=amq.ctag-z4luFyGkGx6UGuX3hseUTw
2017-02-18 17:27:49.703 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/resource, servlet=cn.shiyanjun.platform.scheduled.rest.ResourceServlet@6989da5e
2017-02-18 17:27:49.707 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/scheduling, servlet=cn.shiyanjun.platform.scheduled.rest.SchedulingServlet@9d5509a
2017-02-18 17:27:49.708 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/queueing, servlet=cn.shiyanjun.platform.scheduled.rest.QueueingServlet@3b0090a4
2017-02-18 17:27:49.708 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/cancelJob, servlet=cn.shiyanjun.platform.scheduled.rest.CancelJobServlet@1fa121e2
2017-02-18 17:27:49.709 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/maintenance, servlet=cn.shiyanjun.platform.scheduled.rest.MaintenanceServlet@4116aac9
2017-02-18 17:28:24.382 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Fetch jobs: count=1
2017-02-18 17:28:24.418 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Job fetched: jobId=1, fromStatus=SUBMITTED, toStatus=FETCHED
2017-02-18 17:28:24.419 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Job info: id=1, params={"conditions":[{"expType":"uploadFilter","exps":[{"inputId":"41","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705","expCode":"01000"}]},{"expType":"locationFilter","exps":[{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"},{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"},{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"}]},{"expType":"outputChart","exps":[{"city":"北京市","coordinateType":"1","endTime":"2016-41","startTime":"2016-41","timeType":"2","expCode":"04000"}]}],"excludeCheatedIds":0,"name":"test","outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output","outputType":3,"projectId":47}
2017-02-18 17:28:24.438 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Prepare to request job orchestrate service: Request{method=POST, url=http://127.0.0.1:8080/job/orchestrate/1/1, tag=null}
2017-02-18 17:28:24.899 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Responsed orchestrated job: {
	"jobId":1,
	"jobType":1,
	"stages":[
		{
			"stageLevel":0,
			"stageName":"FilterJobStage-0",
			"tasks":[
				{
					"expCode":"01000",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"上传设备ID条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/id?inputId=41&inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705&idRelationName=e06d0692e65849adb46ec0193da3b411&outputBitmapKey=48a35d0768b242ea876fe8a33a41fdc9\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputId\":\"41\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705\"}],\"expType\":\"uploadFilter\",\"expCode\":\"01000\"}",
					"priority":0,
					"seq":0,
					"seqNo":1,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":1,
			"stageName":"FilterJobStage-1",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=9babc47d926f46f2b555c0f1fea9a985\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seq":0,
					"seqNo":2,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":2,
			"stageName":"FilterJobStage-2",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=a9495fe91ac143ec84a43dd930044f9f\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seq":0,
					"seqNo":3,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":3,
			"stageName":"FilterJobStage-3",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=2f741fa097f0483ebd33c1aa0bf6393e\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seq":0,
					"seqNo":4,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":4,
			"stageName":"MergeJobStage-4",
			"tasks":[
				{
					"expCode":"00000",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"中间结果合并筛选\",\"taskType\":\"1\",\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/calculate/bitmap?bitmapExp=48a35d0768b242ea876fe8a33a41fdc9AND9babc47d926f46f2b555c0f1fea9a985ANDa9495fe91ac143ec84a43dd930044f9fAND2f741fa097f0483ebd33c1aa0bf6393e&excludeCheatedIds=0&outputBitmapKey=e908c85b5f42407eb91c425a6a157be2\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"expCode\":\"00000\"}",
					"priority":0,
					"seq":0,
					"seqNo":5,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":5,
			"stageName":"OutputJobStage-5",
			"tasks":[
				{
					"expCode":"04000",
					"jobId":1,
					"outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate",
					"parsedExpression":"{\"taskDesc\":\"输出聚集点明细\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/match/coordinate?inputBitmapKey=e908c85b5f42407eb91c425a6a157be2&outputPath=/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate&idRelationName=e06d0692e65849adb46ec0193da3b411&coordinateType=1&timeType=2&startTime=2016-41&endTime=2016-41\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"city\":\"北京市\",\"coordinateType\":\"1\",\"timeType\":\"2\",\"startTime\":\"2016-41\",\"endTime\":\"2016-41\"}],\"expType\":\"outputChart\",\"expCode\":\"04000\"}",
					"priority":0,
					"seq":0,
					"seqNo":6,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":6,
			"stageName":"OutputJobStage-6",
			"tasks":[
				{
					"expCode":"00002",
					"inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate",
					"jobId":1,
					"outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap",
					"parsedExpression":"{\"taskDesc\":\"生成热力图数据\",\"hasIdMatch\":true,\"taskType\":2,\"handlerClass\":\"cn.shiyanjun.ddc.handler.HotMapTaskHander\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"city\":\"北京市\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap\"}",
					"priority":0,
					"seq":0,
					"seqNo":7,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.HotMapTaskHander",
					"taskType":2
				}
			]
		}
	]
}
2017-02-18 17:28:25.052 [QUEUEING-WORKER] INFO  cn.shiyanjun.platform.scheduled.component.QueueingManagerImpl - Job queued: {"jobId":1,"jobStatus":"QUEUEING","taskCount":7,"taskId":-1,"seqNo":-1,"taskStatus":"CREATED","lastUpdateTs":1487410105030}
2017-02-18 17:28:29.762 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":1,"lastUpdateTs":1487410109752,"taskId":1,"taskStatus":"SCHEDULED"}
2017-02-18 17:28:29.762 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":1,"lastUpdateTs":1487410109752,"taskId":1,"taskStatus":"SCHEDULED"}
2017-02-18 17:28:29.762 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:28:29.762 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:28:29.764 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:28:29.764 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2017-02-18 17:28:29.764 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:28:29.765 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=1, seqNo=1, taskType=Optional[GREEN_PLUM], taskCount=7
2017-02-18 17:28:29.771 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-02-18 17:28:29.767, jobStatus=SCHEDULED
2017-02-18 17:28:29.774 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=1, seqNo=1, taskStatus=SCHEDULED
2017-02-18 17:28:29.776 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory job state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1487410109774}
2017-02-18 17:28:29.777 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1487410109774}, task={"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SCHEDULED","lastUpdateTs":1487410109774}
2017-02-18 17:28:29.779 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":1,"role":1,"seqNo":1,"taskCount":7,"params":"{\"taskDesc\":\"上传设备ID条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/id?inputId=41&inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705&idRelationName=e06d0692e65849adb46ec0193da3b411&outputBitmapKey=48a35d0768b242ea876fe8a33a41fdc9\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputId\":\"41\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705\"}],\"expType\":\"uploadFilter\",\"expCode\":\"01000\"}"}
2017-02-18 17:28:29.782 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":1,"lastUpdateTs":1487410109780,"taskId":1,"taskStatus":"RUNNING"}
2017-02-18 17:28:29.787 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-02-18 17:28:29.782, jobStatus=RUNNING
2017-02-18 17:28:29.793 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=1, seq=1, startTime=2017-02-18 17:28:29.787, updateTime=2017-02-18 17:28:29.787, taskStatus=RUNNING
2017-02-18 17:28:29.794 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory job state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}
2017-02-18 17:28:29.794 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410109794}
2017-02-18 17:28:29.797 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":0,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-02-18 17:28:47.652 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2017-02-18 17:28:47.924 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":1,"taskType":1,"seqNo":1,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:28:47.927 [pool-1-thread-10] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=1, message={"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":1,"taskType":1,"seqNo":1,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:28:47.930 [pool-1-thread-10] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=1, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:28:47.930 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=1, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:28:47.930 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}]}
2017-02-18 17:28:47.930 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=1, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:28:47.931 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":1,"status":"SUCCEEDED"}
2017-02-18 17:28:47.931 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410109794}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}]
2017-02-18 17:28:47.937 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":1,"status":"SUCCEEDED"}
2017-02-18 17:28:47.951 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=1, taskType=GREEN_PLUM
2017-02-18 17:28:47.951 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:28:47.951 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:28:47.951 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:28:47.951 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-02-18 17:28:47.951 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:28:47.952 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":0,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:28:47.956 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=1, seqNo=1, resultCount=1423, updateTime=2017-02-18 17:28:47.952, taskStatus=SUCCEEDED
2017-02-18 17:28:47.960 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-02-18 17:28:47.957, jobStatus=RUNNING
2017-02-18 17:28:47.962 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":1,"lastUpdateTs":1487410127961,"taskId":1,"taskStatus":"SUCCEEDED"}
2017-02-18 17:28:47.963 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SUCCEEDED","lastUpdateTs":1487410127957}
2017-02-18 17:28:47.963 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-02-18 17:28:47.963 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":1,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:28:49.815 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":2,"lastUpdateTs":1487410129813,"taskId":2,"taskStatus":"SCHEDULED"}
2017-02-18 17:28:49.815 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":2,"lastUpdateTs":1487410129813,"taskId":2,"taskStatus":"SCHEDULED"}
2017-02-18 17:28:49.816 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:28:49.816 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:28:49.816 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:28:49.816 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2017-02-18 17:28:49.816 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:28:49.816 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=2, seqNo=2, taskType=Optional[GREEN_PLUM], taskCount=7
2017-02-18 17:28:49.823 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=2, seqNo=2, taskStatus=SCHEDULED
2017-02-18 17:28:49.823 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SCHEDULED","lastUpdateTs":1487410129823}
2017-02-18 17:28:49.823 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":2,"role":1,"seqNo":2,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=9babc47d926f46f2b555c0f1fea9a985\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2017-02-18 17:28:49.830 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":2,"lastUpdateTs":1487410129825,"taskId":2,"taskStatus":"RUNNING"}
2017-02-18 17:28:49.835 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=2, seq=2, startTime=2017-02-18 17:28:49.83, updateTime=2017-02-18 17:28:49.83, taskStatus=RUNNING
2017-02-18 17:28:49.836 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410129835}
2017-02-18 17:28:49.836 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":1,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-02-18 17:28:57.928 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":2,"taskType":1,"seqNo":2,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:28:57.930 [pool-1-thread-11] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=2, message={"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":2,"taskType":1,"seqNo":2,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:28:57.932 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=2, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:28:57.932 [pool-1-thread-11] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=2, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:28:57.933 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}]}
2017-02-18 17:28:57.934 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=2, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:28:57.935 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":2,"status":"SUCCEEDED"}
2017-02-18 17:28:57.936 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410129835}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}]
2017-02-18 17:28:57.938 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":2,"status":"SUCCEEDED"}
2017-02-18 17:28:57.939 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=2, taskType=GREEN_PLUM
2017-02-18 17:28:57.939 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:28:57.940 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:28:57.940 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:28:57.941 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-02-18 17:28:57.942 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:28:57.942 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":1,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:28:57.951 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=2, seqNo=2, resultCount=1423, updateTime=2017-02-18 17:28:57.943, taskStatus=SUCCEEDED
2017-02-18 17:28:57.957 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-02-18 17:28:57.952, jobStatus=RUNNING
2017-02-18 17:28:57.958 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":2,"lastUpdateTs":1487410137957,"taskId":2,"taskStatus":"SUCCEEDED"}
2017-02-18 17:28:57.959 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SUCCEEDED","lastUpdateTs":1487410137952}
2017-02-18 17:28:57.959 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-02-18 17:28:57.959 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":2,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:28:59.859 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":3,"lastUpdateTs":1487410139855,"taskId":3,"taskStatus":"SCHEDULED"}
2017-02-18 17:28:59.860 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":3,"lastUpdateTs":1487410139855,"taskId":3,"taskStatus":"SCHEDULED"}
2017-02-18 17:28:59.860 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:28:59.861 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:28:59.861 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:28:59.862 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2017-02-18 17:28:59.862 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:28:59.863 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=3, seqNo=3, taskType=Optional[GREEN_PLUM], taskCount=7
2017-02-18 17:28:59.873 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=3, seqNo=3, taskStatus=SCHEDULED
2017-02-18 17:28:59.873 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SCHEDULED","lastUpdateTs":1487410139873}
2017-02-18 17:28:59.874 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":3,"role":1,"seqNo":3,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=a9495fe91ac143ec84a43dd930044f9f\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2017-02-18 17:28:59.876 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":3,"lastUpdateTs":1487410139875,"taskId":3,"taskStatus":"RUNNING"}
2017-02-18 17:28:59.882 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=3, seq=3, startTime=2017-02-18 17:28:59.876, updateTime=2017-02-18 17:28:59.876, taskStatus=RUNNING
2017-02-18 17:28:59.882 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410139882}
2017-02-18 17:28:59.883 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":2,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-02-18 17:29:07.931 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":3,"taskType":1,"seqNo":3,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:29:07.933 [pool-1-thread-12] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=3, message={"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":3,"taskType":1,"seqNo":3,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:29:07.935 [pool-1-thread-12] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=3, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:07.935 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=3, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:07.937 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}]}
2017-02-18 17:29:07.939 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=3, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:07.940 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":3,"status":"SUCCEEDED"}
2017-02-18 17:29:07.941 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410139882}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}]
2017-02-18 17:29:07.942 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":3,"status":"SUCCEEDED"}
2017-02-18 17:29:07.943 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=3, taskType=GREEN_PLUM
2017-02-18 17:29:07.944 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:07.944 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:29:07.945 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:29:07.945 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-02-18 17:29:07.946 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:07.948 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":2,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:29:07.957 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=3, seqNo=3, resultCount=1423, updateTime=2017-02-18 17:29:07.948, taskStatus=SUCCEEDED
2017-02-18 17:29:07.968 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-02-18 17:29:07.963, jobStatus=RUNNING
2017-02-18 17:29:07.972 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":3,"lastUpdateTs":1487410147969,"taskId":3,"taskStatus":"SUCCEEDED"}
2017-02-18 17:29:07.972 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SUCCEEDED","lastUpdateTs":1487410147963}
2017-02-18 17:29:07.973 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-02-18 17:29:07.973 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":3,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:29:09.907 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":4,"lastUpdateTs":1487410149903,"taskId":4,"taskStatus":"SCHEDULED"}
2017-02-18 17:29:09.907 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":4,"lastUpdateTs":1487410149903,"taskId":4,"taskStatus":"SCHEDULED"}
2017-02-18 17:29:09.908 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:09.908 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:29:09.908 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:29:09.909 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2017-02-18 17:29:09.912 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:09.913 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=4, seqNo=4, taskType=Optional[GREEN_PLUM], taskCount=7
2017-02-18 17:29:09.922 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=4, seqNo=4, taskStatus=SCHEDULED
2017-02-18 17:29:09.922 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SCHEDULED","lastUpdateTs":1487410149922}
2017-02-18 17:29:09.924 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":4,"role":1,"seqNo":4,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=2f741fa097f0483ebd33c1aa0bf6393e\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2017-02-18 17:29:09.929 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":4,"lastUpdateTs":1487410149926,"taskId":4,"taskStatus":"RUNNING"}
2017-02-18 17:29:09.933 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=4, seq=4, startTime=2017-02-18 17:29:09.929, updateTime=2017-02-18 17:29:09.929, taskStatus=RUNNING
2017-02-18 17:29:09.934 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410149934}
2017-02-18 17:29:09.934 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":3,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-02-18 17:29:17.933 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":4,"taskType":1,"seqNo":4,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:29:17.933 [pool-1-thread-13] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=4, message={"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":4,"taskType":1,"seqNo":4,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:29:17.934 [pool-1-thread-13] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=4, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:17.934 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=4, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:17.934 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}]}
2017-02-18 17:29:17.935 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=4, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:17.935 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":4,"status":"SUCCEEDED"}
2017-02-18 17:29:17.936 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410149934}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}]
2017-02-18 17:29:17.936 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":4,"status":"SUCCEEDED"}
2017-02-18 17:29:17.936 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=4, taskType=GREEN_PLUM
2017-02-18 17:29:17.936 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:17.936 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:29:17.937 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:29:17.937 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-02-18 17:29:17.937 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:17.937 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":3,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:29:17.943 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=4, seqNo=4, resultCount=1423, updateTime=2017-02-18 17:29:17.937, taskStatus=SUCCEEDED
2017-02-18 17:29:17.949 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-02-18 17:29:17.944, jobStatus=RUNNING
2017-02-18 17:29:17.951 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":4,"lastUpdateTs":1487410157950,"taskId":4,"taskStatus":"SUCCEEDED"}
2017-02-18 17:29:17.951 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SUCCEEDED","lastUpdateTs":1487410157944}
2017-02-18 17:29:17.951 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-02-18 17:29:17.951 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":4,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:29:19.961 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":5,"lastUpdateTs":1487410159958,"taskId":5,"taskStatus":"SCHEDULED"}
2017-02-18 17:29:19.965 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":5,"lastUpdateTs":1487410159958,"taskId":5,"taskStatus":"SCHEDULED"}
2017-02-18 17:29:19.967 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:19.968 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:29:19.968 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:29:19.968 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2017-02-18 17:29:19.970 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:19.971 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=5, seqNo=5, taskType=Optional[GREEN_PLUM], taskCount=7
2017-02-18 17:29:19.985 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=5, seqNo=5, taskStatus=SCHEDULED
2017-02-18 17:29:19.986 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SCHEDULED","lastUpdateTs":1487410159986}
2017-02-18 17:29:19.987 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":5,"role":1,"seqNo":5,"taskCount":7,"params":"{\"taskDesc\":\"中间结果合并筛选\",\"taskType\":\"1\",\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/calculate/bitmap?bitmapExp=48a35d0768b242ea876fe8a33a41fdc9AND9babc47d926f46f2b555c0f1fea9a985ANDa9495fe91ac143ec84a43dd930044f9fAND2f741fa097f0483ebd33c1aa0bf6393e&excludeCheatedIds=0&outputBitmapKey=e908c85b5f42407eb91c425a6a157be2\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"expCode\":\"00000\"}"}
2017-02-18 17:29:19.995 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":5,"lastUpdateTs":1487410159992,"taskId":5,"taskStatus":"RUNNING"}
2017-02-18 17:29:20.003 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=5, seq=5, startTime=2017-02-18 17:29:19.995, updateTime=2017-02-18 17:29:19.995, taskStatus=RUNNING
2017-02-18 17:29:20.003 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410160003}
2017-02-18 17:29:20.004 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":4,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-02-18 17:29:27.936 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":5,"taskType":1,"seqNo":5,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:29:27.937 [pool-1-thread-14] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=5, message={"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":5,"taskType":1,"seqNo":5,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:29:27.939 [pool-1-thread-14] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=5, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:27.939 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=5, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:27.940 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}]}
2017-02-18 17:29:27.941 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=5, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:27.941 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":5,"status":"SUCCEEDED"}
2017-02-18 17:29:27.942 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410160003}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}]
2017-02-18 17:29:27.943 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":5,"status":"SUCCEEDED"}
2017-02-18 17:29:27.944 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=5, taskType=GREEN_PLUM
2017-02-18 17:29:27.944 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:27.945 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:29:27.945 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:29:27.946 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-02-18 17:29:27.946 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:27.947 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":4,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:29:27.953 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=5, seqNo=5, resultCount=1423, updateTime=2017-02-18 17:29:27.947, taskStatus=SUCCEEDED
2017-02-18 17:29:27.958 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-02-18 17:29:27.954, jobStatus=RUNNING
2017-02-18 17:29:27.960 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":5,"lastUpdateTs":1487410167958,"taskId":5,"taskStatus":"SUCCEEDED"}
2017-02-18 17:29:27.960 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SUCCEEDED","lastUpdateTs":1487410167954}
2017-02-18 17:29:27.961 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-02-18 17:29:27.961 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":5,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:29:30.026 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":6,"lastUpdateTs":1487410170023,"taskId":6,"taskStatus":"SCHEDULED"}
2017-02-18 17:29:30.027 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":6,"lastUpdateTs":1487410170023,"taskId":6,"taskStatus":"SCHEDULED"}
2017-02-18 17:29:30.027 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:30.027 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:29:30.027 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:29:30.028 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2017-02-18 17:29:30.028 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:30.028 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=6, seqNo=6, taskType=Optional[GREEN_PLUM], taskCount=7
2017-02-18 17:29:30.036 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=6, seqNo=6, taskStatus=SCHEDULED
2017-02-18 17:29:30.036 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SCHEDULED","lastUpdateTs":1487410170036}
2017-02-18 17:29:30.037 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":6,"role":1,"seqNo":6,"taskCount":7,"params":"{\"taskDesc\":\"输出聚集点明细\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/match/coordinate?inputBitmapKey=e908c85b5f42407eb91c425a6a157be2&outputPath=/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate&idRelationName=e06d0692e65849adb46ec0193da3b411&coordinateType=1&timeType=2&startTime=2016-41&endTime=2016-41\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"city\":\"北京市\",\"coordinateType\":\"1\",\"timeType\":\"2\",\"startTime\":\"2016-41\",\"endTime\":\"2016-41\"}],\"expType\":\"outputChart\",\"expCode\":\"04000\"}"}
2017-02-18 17:29:30.042 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":6,"lastUpdateTs":1487410170039,"taskId":6,"taskStatus":"RUNNING"}
2017-02-18 17:29:30.050 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=6, seq=6, startTime=2017-02-18 17:29:30.042, updateTime=2017-02-18 17:29:30.042, taskStatus=RUNNING
2017-02-18 17:29:30.050 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410170050}
2017-02-18 17:29:30.051 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":5,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-02-18 17:29:37.938 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":6,"taskType":1,"seqNo":6,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:29:37.940 [pool-1-thread-15] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=6, message={"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":6,"taskType":1,"seqNo":6,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:29:37.941 [pool-1-thread-15] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=6, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:37.941 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=6, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:37.942 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}]}
2017-02-18 17:29:37.942 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=6, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:37.943 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":6,"status":"SUCCEEDED"}
2017-02-18 17:29:37.943 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410170050}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}]
2017-02-18 17:29:37.944 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":6,"status":"SUCCEEDED"}
2017-02-18 17:29:37.944 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=6, taskType=GREEN_PLUM
2017-02-18 17:29:37.944 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:37.945 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:29:37.945 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:29:37.945 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-02-18 17:29:37.945 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:37.946 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":5,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:29:37.954 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=6, seqNo=6, resultCount=1423, updateTime=2017-02-18 17:29:37.946, taskStatus=SUCCEEDED
2017-02-18 17:29:37.963 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-02-18 17:29:37.956, jobStatus=RUNNING
2017-02-18 17:29:37.967 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":6,"lastUpdateTs":1487410177964,"taskId":6,"taskStatus":"SUCCEEDED"}
2017-02-18 17:29:37.968 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SUCCEEDED","lastUpdateTs":1487410177956}
2017-02-18 17:29:37.968 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-02-18 17:29:37.969 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":6,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:29:40.063 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":7,"lastUpdateTs":1487410180061,"taskId":7,"taskStatus":"SCHEDULED"}
2017-02-18 17:29:40.063 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":7,"lastUpdateTs":1487410180061,"taskId":7,"taskStatus":"SCHEDULED"}
2017-02-18 17:29:40.063 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:40.063 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:29:40.063 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:29:40.065 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=1/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-02-18 17:29:40.065 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:40.065 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=JAVA_APPLICATION,  jobId=1, taskId=7, seqNo=7, taskType=Optional[JAVA_APPLICATION], taskCount=7
2017-02-18 17:29:40.074 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=7, seqNo=7, taskStatus=SCHEDULED
2017-02-18 17:29:40.075 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":7,"seqNo":7,"taskType":"JAVA_APPLICATION","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SCHEDULED","lastUpdateTs":1487410180075}
2017-02-18 17:29:40.076 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":7,"role":2,"seqNo":7,"taskCount":7,"params":"{\"taskDesc\":\"生成热力图数据\",\"hasIdMatch\":true,\"taskType\":2,\"handlerClass\":\"cn.shiyanjun.ddc.handler.HotMapTaskHander\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"city\":\"北京市\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap\"}"}
2017-02-18 17:29:40.080 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":7,"lastUpdateTs":1487410180078,"taskId":7,"taskStatus":"RUNNING"}
2017-02-18 17:29:40.087 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=7, seq=7, startTime=2017-02-18 17:29:40.08, updateTime=2017-02-18 17:29:40.08, taskStatus=RUNNING
2017-02-18 17:29:40.088 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}, task={"jobId":1,"taskId":7,"seqNo":7,"taskType":"JAVA_APPLICATION","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410180087}
2017-02-18 17:29:40.088 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":6,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-02-18 17:29:47.939 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":7,"taskType":2,"seqNo":7,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:29:47.941 [pool-1-thread-16] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=7, message={"type":"taskProgress","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","tasks":[{"jobId":1,"taskId":7,"taskType":2,"seqNo":7,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-02-18 17:29:47.942 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=7, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"taskId":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:47.942 [pool-1-thread-16] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=7, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"taskId":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:47.943 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"taskId":7,"status":"SUCCEEDED"}]}
2017-02-18 17:29:47.943 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=7, message={"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"taskId":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-02-18 17:29:47.944 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":7,"status":"SUCCEEDED"}
2017-02-18 17:29:47.945 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":7,"seqNo":7,"taskType":"JAVA_APPLICATION","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410180087}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1487410109794}]
2017-02-18 17:29:47.945 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskId":7,"status":"SUCCEEDED"}
2017-02-18 17:29:47.946 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=7, taskType=JAVA_APPLICATION
2017-02-18 17:29:47.946 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:47.946 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-02-18 17:29:47.946 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-02-18 17:29:47.946 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-02-18 17:29:47.946 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-02-18 17:29:47.947 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":6,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-02-18 17:29:47.955 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=7, seqNo=7, resultCount=1423, updateTime=2017-02-18 17:29:47.947, taskStatus=SUCCEEDED
2017-02-18 17:29:47.965 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-02-18 17:29:47.958, jobStatus=SUCCEEDED
2017-02-18 17:29:47.966 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory job state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SUCCEEDED","lastUpdateTs":1487410187966}
2017-02-18 17:29:47.966 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Moving in-mem job: runningJobIdToInfos -> completedJobIdToInfos
2017-02-18 17:29:47.967 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SUCCEEDED","lastUpdateTs":1487410127957}
2017-02-18 17:29:47.967 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SUCCEEDED","lastUpdateTs":1487410137952}
2017-02-18 17:29:47.967 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SUCCEEDED","lastUpdateTs":1487410147963}
2017-02-18 17:29:47.967 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SUCCEEDED","lastUpdateTs":1487410157944}
2017-02-18 17:29:47.968 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SUCCEEDED","lastUpdateTs":1487410167954}
2017-02-18 17:29:47.968 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"SUCCEEDED","lastUpdateTs":1487410177956}
2017-02-18 17:29:47.968 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":7,"seqNo":7,"taskType":"JAVA_APPLICATION","platform_id":"01683c548bc74e7c8d4e78020f4c68c8","taskStatus":"RUNNING","lastUpdateTs":1487410180087}
2017-02-18 17:29:47.968 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem job moved: {"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SUCCEEDED","lastUpdateTs":1487410187966}
2017-02-18 17:29:47.968 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":1,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-02-18 17:29:47.968 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":7,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
