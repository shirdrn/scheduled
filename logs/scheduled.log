2016-12-11 23:03:40.260 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=config.properties
2016-12-11 23:03:40.441 [main] INFO  cn.shiyanjun.platform.scheduled.ScheduledMain - Platform ID: 4e5cff3d8b9d4c2d89d8e9e64e78fdc3
2016-12-11 23:03:40.448 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=redis.properties
2016-12-11 23:03:40.901 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-11 23:03:40.979 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - Configured task types: {q_user_job=[JAVA_APPLICATION, GREEN_PLUM], q_enterprise_job=[JAVA_APPLICATION, GREEN_PLUM]}
2016-12-11 23:03:40.979 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - Configured resources: {q_user_job={JAVA_APPLICATION=1, GREEN_PLUM=1}, q_enterprise_job={JAVA_APPLICATION=0, GREEN_PLUM=0}}
2016-12-11 23:03:40.983 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Configs: fetchJobInterval=3000, initialDelay=5000
2016-12-11 23:03:40.994 [main] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Configs: jobOrchestrateServiceUrl=http://localhost:8080/job/orchestrate
2016-12-11 23:03:40.995 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Protocol: jobOrchestrationProtocol=REST
2016-12-11 23:03:40.996 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Protocol: jobFetchProtocol=MYSQL
2016-12-11 23:03:41.006 [main] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Configs: isRecoveryFeatureEnabled=false
2016-12-11 23:03:41.006 [main] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Configs: keptHistoryJobMaxCount=200
2016-12-11 23:03:41.008 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=queueings.properties
2016-12-11 23:03:41.097 [main] INFO  cn.shiyanjun.platform.scheduled.component.DefaultRecoveryManager - Start to read messages from MQ ...
2016-12-11 23:03:41.099 [main] INFO  cn.shiyanjun.platform.scheduled.component.DefaultRecoveryManager - Complete to read MQ messages: q=/scheduled/mq_heartbeat
2016-12-11 23:03:41.139 [main] INFO  cn.shiyanjun.platform.scheduled.component.DefaultRecoveryManager - Completed jobs: []
2016-12-11 23:03:41.143 [main] INFO  cn.shiyanjun.platform.scheduled.component.DefaultRecoveryManager - Pending recovery status: jobCount=0, jobs={}
2016-12-11 23:03:41.151 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Fetch job pool started: java.util.concurrent.Executors$DelegatedScheduledExecutorService@38364841
2016-12-11 23:03:41.168 [SCHEDULED-003] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRunnableConsumer - Consumer started: consumerTag=amq.ctag-xXdnyzq0M8B9dcoqMj5hDQ
2016-12-11 23:03:49.172 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Fetch jobs: count=1
2016-12-11 23:03:49.202 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Job fetched: jobId=1, fromStatus=SUBMITTED, toStatus=FETCHED
2016-12-11 23:03:49.202 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Job info: id=1, params={"conditions":[{"expType":"uploadFilter","exps":[{"inputId":"41","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705","expCode":"01000"}]},{"expType":"locationFilter","exps":[{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"},{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"},{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"}]},{"expType":"outputChart","exps":[{"city":"北京市","coordinateType":"1","endTime":"2016-41","startTime":"2016-41","timeType":"2","expCode":"04000"}]}],"excludeCheatedIds":0,"name":"test","outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output","outputType":3,"projectId":47}
2016-12-11 23:03:49.213 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Prepare to request job orchestrate service: Request{method=POST, url=http://localhost:8080/job/orchestrate/1/1, tag=null}
2016-12-11 23:03:50.030 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Responsed orchestrated job: {
	"jobId":1,
	"jobType":1,
	"stages":[
		{
			"stageLevel":0,
			"stageName":"FilterJobStage-0",
			"tasks":[
				{
					"expCode":"01000",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"上传设备ID条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/id?inputId=41&inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705&idRelationName=9e92450f8799414a9a4865a8d8d289f1&outputBitmapKey=8f2c8e0f3e514f3c97f7b76bb24c9d7e\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputId\":\"41\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705\"}],\"expType\":\"uploadFilter\",\"expCode\":\"01000\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":1,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":1,
			"stageName":"FilterJobStage-1",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=4d5eec59f4ac47f4be2acc5049e5e31e\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":2,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":2,
			"stageName":"FilterJobStage-2",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=50d78d2217844e07925a2e0b0f92d800\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":3,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":3,
			"stageName":"FilterJobStage-3",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=02b79d5cd65844fca309c4c1767bb17d\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":4,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":4,
			"stageName":"MergeJobStage-4",
			"tasks":[
				{
					"expCode":"00000",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"中间结果合并筛选\",\"taskType\":\"1\",\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/calculate/bitmap?bitmapExp=8f2c8e0f3e514f3c97f7b76bb24c9d7eAND4d5eec59f4ac47f4be2acc5049e5e31eAND50d78d2217844e07925a2e0b0f92d800AND02b79d5cd65844fca309c4c1767bb17d&excludeCheatedIds=0&outputBitmapKey=6f13c13c5d774545ac64ecd0b2c267be\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"expCode\":\"00000\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":5,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":5,
			"stageName":"OutputJobStage-5",
			"tasks":[
				{
					"expCode":"04000",
					"jobId":1,
					"outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate",
					"parsedExpression":"{\"taskDesc\":\"输出聚集点明细\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/match/coordinate?inputBitmapKey=6f13c13c5d774545ac64ecd0b2c267be&outputPath=/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate&idRelationName=9e92450f8799414a9a4865a8d8d289f1&coordinateType=1&timeType=2&startTime=2016-41&endTime=2016-41\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"city\":\"北京市\",\"coordinateType\":\"1\",\"timeType\":\"2\",\"startTime\":\"2016-41\",\"endTime\":\"2016-41\"}],\"expType\":\"outputChart\",\"expCode\":\"04000\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":6,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":6,
			"stageName":"OutputJobStage-6",
			"tasks":[
				{
					"expCode":"00002",
					"inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate",
					"jobId":1,
					"outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap",
					"parsedExpression":"{\"taskDesc\":\"生成热力图数据\",\"hasIdMatch\":true,\"taskType\":2,\"handlerClass\":\"cn.shiyanjun.ddc.handler.HotMapTaskHander\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"city\":\"北京市\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap\"}",
					"priority":0,
					"seqNo":0,
					"serialNo":7,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.HotMapTaskHander",
					"taskType":2
				}
			]
		}
	]
}
2016-12-11 23:03:50.401 [QUEUEING-WORKER] INFO  cn.shiyanjun.platform.scheduled.component.DefaultQueueingManager - Job queued: {"jobId":1,"jobStatus":"QUEUEING","taskCount":7,"taskId":-1,"serialNo":-1,"taskStatus":"WAIT_TO_BE_SCHEDULED","lastUpdateTs":1481468630287}
2016-12-11 23:03:51.265 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468631235,"taskId":1,"taskStatus":"SCHEDULED","serialNo":1}
2016-12-11 23:03:51.269 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468631235,"taskId":1,"taskStatus":"SCHEDULED","serialNo":1}
2016-12-11 23:03:51.269 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:03:51.269 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:03:51.278 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2016-12-11 23:03:51.297 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:03:51.297 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:03:51.301 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to schedule: queue=q_user_job, taskType=GREEN_PLUM,  jobId=1, taskId=1, serialNo=1, taskType=Optional[GREEN_PLUM], taskCount=7
2016-12-11 23:03:51.312 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db job state changed: jobId=1, updateTime=2016-12-11 23:03:51.304, jobStatus=SCHEDULED
2016-12-11 23:03:51.317 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=1, serialNo=1, taskStatus=SCHEDULED
2016-12-11 23:03:51.320 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory job state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468631318}
2016-12-11 23:03:51.321 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468631318}, task={"jobId":1,"taskId":1,"serialNo":1,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SCHEDULED","lastUpdateTs":1481468631318}
2016-12-11 23:03:51.326 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":1,"role":1,"serialNo":1,"taskCount":7,"params":"{\"taskDesc\":\"上传设备ID条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/id?inputId=41&inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705&idRelationName=9e92450f8799414a9a4865a8d8d289f1&outputBitmapKey=8f2c8e0f3e514f3c97f7b76bb24c9d7e\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputId\":\"41\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705\"}],\"expType\":\"uploadFilter\",\"expCode\":\"01000\"}"}
2016-12-11 23:03:51.328 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631326,"taskId":1,"taskStatus":"RUNNING","serialNo":1}
2016-12-11 23:03:51.334 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db job state changed: jobId=1, updateTime=2016-12-11 23:03:51.329, jobStatus=RUNNING
2016-12-11 23:03:51.340 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=1, serialNo=1, startTime=2016-12-11 23:03:51.334, updateTime=2016-12-11 23:03:51.334, taskStatus=RUNNING
2016-12-11 23:03:51.340 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory job state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}
2016-12-11 23:03:51.341 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":1,"serialNo":1,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468631340}
2016-12-11 23:03:51.349 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=0, failedCount=0, runningTaskCount=1
2016-12-11 23:04:28.964 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-11 23:04:29.241 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":1,"taskType":1,"serialNo":1,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:04:29.245 [pool-1-thread-10] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Message received: deliveryTag=1, message={"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":1,"taskType":1,"serialNo":1,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:04:29.248 [pool-1-thread-10] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Added to rawHeartbeatMessages: deliveryTag=1, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":1,"serialNo":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:04:29.248 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Dispatching fresh tasks response: deliveryTag=1, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":1,"serialNo":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:04:29.249 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Takes a fresh tasks response: {"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":1,"serialNo":1,"status":"SUCCEEDED"}]}
2016-12-11 23:04:29.250 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to handle heartbeat: deliveryTag=1, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":1,"serialNo":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:04:29.250 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":1,"serialNo":1,"status":"SUCCEEDED"}
2016-12-11 23:04:29.251 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Get in-memory infos: taskInfo={"jobId":1,"taskId":1,"serialNo":1,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468631340}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}
2016-12-11 23:04:29.254 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":1,"serialNo":1,"status":"SUCCEEDED"}
2016-12-11 23:04:29.254 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:04:29.254 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:04:29.255 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2016-12-11 23:04:29.255 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:04:29.255 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:04:29.255 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=0, failedCount=0, runningTaskCount=0
2016-12-11 23:04:29.260 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=1, serialNo=1, resultCount=1423, updateTime=2016-12-11 23:04:29.256, taskStatus=SUCCEEDED
2016-12-11 23:04:29.265 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db job state changed: jobId=1, updateTime=2016-12-11 23:04:29.261
2016-12-11 23:04:29.266 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","lastUpdateTs":1481468669265,"taskId":1,"taskStatus":"SUCCEEDED","serialNo":1}
2016-12-11 23:04:29.267 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":1,"serialNo":1,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SUCCEEDED","lastUpdateTs":1481468669261}
2016-12-11 23:04:29.267 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=1, failedCount=0, runningTaskCount=0
2016-12-11 23:04:31.394 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468671390,"taskId":2,"taskStatus":"SCHEDULED","serialNo":2}
2016-12-11 23:04:31.395 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468671390,"taskId":2,"taskStatus":"SCHEDULED","serialNo":2}
2016-12-11 23:04:31.396 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:04:31.396 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:04:31.397 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2016-12-11 23:04:31.397 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:04:31.398 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:04:31.398 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to schedule: queue=q_user_job, taskType=GREEN_PLUM,  jobId=1, taskId=2, serialNo=2, taskType=Optional[GREEN_PLUM], taskCount=7
2016-12-11 23:04:31.413 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=2, serialNo=2, taskStatus=SCHEDULED
2016-12-11 23:04:31.413 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":2,"serialNo":2,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SCHEDULED","lastUpdateTs":1481468671413}
2016-12-11 23:04:31.414 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":2,"role":1,"serialNo":2,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=4d5eec59f4ac47f4be2acc5049e5e31e\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2016-12-11 23:04:31.416 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468671414,"taskId":2,"taskStatus":"RUNNING","serialNo":2}
2016-12-11 23:04:31.422 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=2, serialNo=2, startTime=2016-12-11 23:04:31.417, updateTime=2016-12-11 23:04:31.417, taskStatus=RUNNING
2016-12-11 23:04:31.422 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":2,"serialNo":2,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468671422}
2016-12-11 23:04:31.422 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=1, failedCount=0, runningTaskCount=1
2016-12-11 23:04:49.917 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-11 23:04:50.187 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":2,"taskType":1,"serialNo":2,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:04:50.188 [pool-1-thread-11] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Message received: deliveryTag=2, message={"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":2,"taskType":1,"serialNo":2,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:04:50.189 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Dispatching fresh tasks response: deliveryTag=2, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":2,"serialNo":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:04:50.189 [pool-1-thread-11] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Added to rawHeartbeatMessages: deliveryTag=2, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":2,"serialNo":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:04:50.190 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Takes a fresh tasks response: {"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":2,"serialNo":2,"status":"SUCCEEDED"}]}
2016-12-11 23:04:50.190 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to handle heartbeat: deliveryTag=2, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":2,"serialNo":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:04:50.190 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":2,"serialNo":2,"status":"SUCCEEDED"}
2016-12-11 23:04:50.191 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Get in-memory infos: taskInfo={"jobId":1,"taskId":2,"serialNo":2,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468671422}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}
2016-12-11 23:04:50.191 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":2,"serialNo":2,"status":"SUCCEEDED"}
2016-12-11 23:04:50.192 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:04:50.192 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:04:50.192 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2016-12-11 23:04:50.192 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:04:50.192 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:04:50.193 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=1, failedCount=0, runningTaskCount=0
2016-12-11 23:04:50.197 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=2, serialNo=2, resultCount=1423, updateTime=2016-12-11 23:04:50.193, taskStatus=SUCCEEDED
2016-12-11 23:04:50.201 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db job state changed: jobId=1, updateTime=2016-12-11 23:04:50.198
2016-12-11 23:04:50.202 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","lastUpdateTs":1481468690201,"taskId":2,"taskStatus":"SUCCEEDED","serialNo":2}
2016-12-11 23:04:50.203 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":2,"serialNo":2,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SUCCEEDED","lastUpdateTs":1481468690198}
2016-12-11 23:04:50.203 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=2, failedCount=0, runningTaskCount=0
2016-12-11 23:04:51.458 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468691456,"taskId":3,"taskStatus":"SCHEDULED","serialNo":3}
2016-12-11 23:04:51.458 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468691456,"taskId":3,"taskStatus":"SCHEDULED","serialNo":3}
2016-12-11 23:04:51.458 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:04:51.458 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:04:51.458 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2016-12-11 23:04:51.458 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:04:51.458 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:04:51.458 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to schedule: queue=q_user_job, taskType=GREEN_PLUM,  jobId=1, taskId=3, serialNo=3, taskType=Optional[GREEN_PLUM], taskCount=7
2016-12-11 23:04:51.464 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=3, serialNo=3, taskStatus=SCHEDULED
2016-12-11 23:04:51.464 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":3,"serialNo":3,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SCHEDULED","lastUpdateTs":1481468691464}
2016-12-11 23:04:51.465 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":3,"role":1,"serialNo":3,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=50d78d2217844e07925a2e0b0f92d800\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2016-12-11 23:04:51.467 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468691465,"taskId":3,"taskStatus":"RUNNING","serialNo":3}
2016-12-11 23:04:51.472 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=3, serialNo=3, startTime=2016-12-11 23:04:51.467, updateTime=2016-12-11 23:04:51.467, taskStatus=RUNNING
2016-12-11 23:04:51.472 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":3,"serialNo":3,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468691472}
2016-12-11 23:04:51.472 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=2, failedCount=0, runningTaskCount=1
2016-12-11 23:05:03.908 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-11 23:05:04.189 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":3,"taskType":1,"serialNo":3,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:05:04.190 [pool-1-thread-12] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Message received: deliveryTag=3, message={"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":3,"taskType":1,"serialNo":3,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:05:04.190 [pool-1-thread-12] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Added to rawHeartbeatMessages: deliveryTag=3, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":3,"serialNo":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:04.190 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Dispatching fresh tasks response: deliveryTag=3, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":3,"serialNo":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:04.191 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Takes a fresh tasks response: {"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":3,"serialNo":3,"status":"SUCCEEDED"}]}
2016-12-11 23:05:04.191 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to handle heartbeat: deliveryTag=3, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":3,"serialNo":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:04.191 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":3,"serialNo":3,"status":"SUCCEEDED"}
2016-12-11 23:05:04.192 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Get in-memory infos: taskInfo={"jobId":1,"taskId":3,"serialNo":3,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468691472}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}
2016-12-11 23:05:04.192 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":3,"serialNo":3,"status":"SUCCEEDED"}
2016-12-11 23:05:04.192 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:04.192 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:05:04.192 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2016-12-11 23:05:04.193 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:05:04.193 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:04.193 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=2, failedCount=0, runningTaskCount=0
2016-12-11 23:05:04.199 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=3, serialNo=3, resultCount=1423, updateTime=2016-12-11 23:05:04.193, taskStatus=SUCCEEDED
2016-12-11 23:05:04.204 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db job state changed: jobId=1, updateTime=2016-12-11 23:05:04.2
2016-12-11 23:05:04.206 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","lastUpdateTs":1481468704205,"taskId":3,"taskStatus":"SUCCEEDED","serialNo":3}
2016-12-11 23:05:04.206 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":3,"serialNo":3,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SUCCEEDED","lastUpdateTs":1481468704200}
2016-12-11 23:05:04.206 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=3, failedCount=0, runningTaskCount=0
2016-12-11 23:05:06.500 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468706496,"taskId":4,"taskStatus":"SCHEDULED","serialNo":4}
2016-12-11 23:05:06.500 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468706496,"taskId":4,"taskStatus":"SCHEDULED","serialNo":4}
2016-12-11 23:05:06.501 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:06.502 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:05:06.502 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2016-12-11 23:05:06.502 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:05:06.503 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:06.503 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to schedule: queue=q_user_job, taskType=GREEN_PLUM,  jobId=1, taskId=4, serialNo=4, taskType=Optional[GREEN_PLUM], taskCount=7
2016-12-11 23:05:06.516 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=4, serialNo=4, taskStatus=SCHEDULED
2016-12-11 23:05:06.517 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":4,"serialNo":4,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SCHEDULED","lastUpdateTs":1481468706516}
2016-12-11 23:05:06.517 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":4,"role":1,"serialNo":4,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=02b79d5cd65844fca309c4c1767bb17d\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2016-12-11 23:05:06.519 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468706517,"taskId":4,"taskStatus":"RUNNING","serialNo":4}
2016-12-11 23:05:06.525 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=4, serialNo=4, startTime=2016-12-11 23:05:06.519, updateTime=2016-12-11 23:05:06.519, taskStatus=RUNNING
2016-12-11 23:05:06.525 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":4,"serialNo":4,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468706525}
2016-12-11 23:05:06.525 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=3, failedCount=0, runningTaskCount=1
2016-12-11 23:05:16.802 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-11 23:05:17.062 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":4,"taskType":1,"serialNo":4,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:05:17.062 [pool-1-thread-13] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Message received: deliveryTag=4, message={"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":4,"taskType":1,"serialNo":4,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:05:17.063 [pool-1-thread-13] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Added to rawHeartbeatMessages: deliveryTag=4, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":4,"serialNo":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:17.063 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Dispatching fresh tasks response: deliveryTag=4, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":4,"serialNo":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:17.064 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Takes a fresh tasks response: {"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":4,"serialNo":4,"status":"SUCCEEDED"}]}
2016-12-11 23:05:17.064 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to handle heartbeat: deliveryTag=4, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":4,"serialNo":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:17.065 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":4,"serialNo":4,"status":"SUCCEEDED"}
2016-12-11 23:05:17.065 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Get in-memory infos: taskInfo={"jobId":1,"taskId":4,"serialNo":4,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468706525}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}
2016-12-11 23:05:17.067 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":4,"serialNo":4,"status":"SUCCEEDED"}
2016-12-11 23:05:17.067 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:17.067 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:05:17.067 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2016-12-11 23:05:17.067 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:05:17.068 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:17.068 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=3, failedCount=0, runningTaskCount=0
2016-12-11 23:05:17.074 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=4, serialNo=4, resultCount=1423, updateTime=2016-12-11 23:05:17.068, taskStatus=SUCCEEDED
2016-12-11 23:05:17.081 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db job state changed: jobId=1, updateTime=2016-12-11 23:05:17.075
2016-12-11 23:05:17.082 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","lastUpdateTs":1481468717081,"taskId":4,"taskStatus":"SUCCEEDED","serialNo":4}
2016-12-11 23:05:17.083 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":4,"serialNo":4,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SUCCEEDED","lastUpdateTs":1481468717075}
2016-12-11 23:05:17.083 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=4, failedCount=0, runningTaskCount=0
2016-12-11 23:05:21.555 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468721552,"taskId":5,"taskStatus":"SCHEDULED","serialNo":5}
2016-12-11 23:05:21.555 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468721552,"taskId":5,"taskStatus":"SCHEDULED","serialNo":5}
2016-12-11 23:05:21.556 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:21.556 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:05:21.556 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2016-12-11 23:05:21.557 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:05:21.557 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:21.558 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to schedule: queue=q_user_job, taskType=GREEN_PLUM,  jobId=1, taskId=5, serialNo=5, taskType=Optional[GREEN_PLUM], taskCount=7
2016-12-11 23:05:21.567 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=5, serialNo=5, taskStatus=SCHEDULED
2016-12-11 23:05:21.568 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":5,"serialNo":5,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SCHEDULED","lastUpdateTs":1481468721568}
2016-12-11 23:05:21.574 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":5,"role":1,"serialNo":5,"taskCount":7,"params":"{\"taskDesc\":\"中间结果合并筛选\",\"taskType\":\"1\",\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/calculate/bitmap?bitmapExp=8f2c8e0f3e514f3c97f7b76bb24c9d7eAND4d5eec59f4ac47f4be2acc5049e5e31eAND50d78d2217844e07925a2e0b0f92d800AND02b79d5cd65844fca309c4c1767bb17d&excludeCheatedIds=0&outputBitmapKey=6f13c13c5d774545ac64ecd0b2c267be\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"expCode\":\"00000\"}"}
2016-12-11 23:05:21.577 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468721574,"taskId":5,"taskStatus":"RUNNING","serialNo":5}
2016-12-11 23:05:21.586 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=5, serialNo=5, startTime=2016-12-11 23:05:21.578, updateTime=2016-12-11 23:05:21.578, taskStatus=RUNNING
2016-12-11 23:05:21.586 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":5,"serialNo":5,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468721586}
2016-12-11 23:05:21.587 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=4, failedCount=0, runningTaskCount=1
2016-12-11 23:05:24.602 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-11 23:05:24.865 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":5,"taskType":1,"serialNo":5,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:05:24.866 [pool-1-thread-14] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Message received: deliveryTag=5, message={"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":5,"taskType":1,"serialNo":5,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:05:24.867 [pool-1-thread-14] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Added to rawHeartbeatMessages: deliveryTag=5, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":5,"serialNo":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:24.867 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Dispatching fresh tasks response: deliveryTag=5, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":5,"serialNo":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:24.867 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Takes a fresh tasks response: {"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":5,"serialNo":5,"status":"SUCCEEDED"}]}
2016-12-11 23:05:24.867 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to handle heartbeat: deliveryTag=5, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":5,"serialNo":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:24.867 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":5,"serialNo":5,"status":"SUCCEEDED"}
2016-12-11 23:05:24.868 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Get in-memory infos: taskInfo={"jobId":1,"taskId":5,"serialNo":5,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468721586}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}
2016-12-11 23:05:24.868 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":5,"serialNo":5,"status":"SUCCEEDED"}
2016-12-11 23:05:24.868 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:24.869 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:05:24.869 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2016-12-11 23:05:24.869 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:05:24.869 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:24.869 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=4, failedCount=0, runningTaskCount=0
2016-12-11 23:05:24.874 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=5, serialNo=5, resultCount=1423, updateTime=2016-12-11 23:05:24.869, taskStatus=SUCCEEDED
2016-12-11 23:05:24.878 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db job state changed: jobId=1, updateTime=2016-12-11 23:05:24.875
2016-12-11 23:05:24.879 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","lastUpdateTs":1481468724878,"taskId":5,"taskStatus":"SUCCEEDED","serialNo":5}
2016-12-11 23:05:24.880 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":5,"serialNo":5,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SUCCEEDED","lastUpdateTs":1481468724875}
2016-12-11 23:05:24.880 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=5, failedCount=0, runningTaskCount=0
2016-12-11 23:05:26.614 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468726613,"taskId":6,"taskStatus":"SCHEDULED","serialNo":6}
2016-12-11 23:05:26.614 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468726613,"taskId":6,"taskStatus":"SCHEDULED","serialNo":6}
2016-12-11 23:05:26.614 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:26.614 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:05:26.614 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2016-12-11 23:05:26.614 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:05:26.614 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:26.614 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to schedule: queue=q_user_job, taskType=GREEN_PLUM,  jobId=1, taskId=6, serialNo=6, taskType=Optional[GREEN_PLUM], taskCount=7
2016-12-11 23:05:26.619 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=6, serialNo=6, taskStatus=SCHEDULED
2016-12-11 23:05:26.619 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":6,"serialNo":6,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SCHEDULED","lastUpdateTs":1481468726619}
2016-12-11 23:05:26.619 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":6,"role":1,"serialNo":6,"taskCount":7,"params":"{\"taskDesc\":\"输出聚集点明细\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/match/coordinate?inputBitmapKey=6f13c13c5d774545ac64ecd0b2c267be&outputPath=/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate&idRelationName=9e92450f8799414a9a4865a8d8d289f1&coordinateType=1&timeType=2&startTime=2016-41&endTime=2016-41\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"city\":\"北京市\",\"coordinateType\":\"1\",\"timeType\":\"2\",\"startTime\":\"2016-41\",\"endTime\":\"2016-41\"}],\"expType\":\"outputChart\",\"expCode\":\"04000\"}"}
2016-12-11 23:05:26.620 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468726619,"taskId":6,"taskStatus":"RUNNING","serialNo":6}
2016-12-11 23:05:26.624 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=6, serialNo=6, startTime=2016-12-11 23:05:26.62, updateTime=2016-12-11 23:05:26.62, taskStatus=RUNNING
2016-12-11 23:05:26.624 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":6,"serialNo":6,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468726624}
2016-12-11 23:05:26.625 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=5, failedCount=0, runningTaskCount=1
2016-12-11 23:05:34.807 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-11 23:05:35.090 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":6,"taskType":1,"serialNo":6,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:05:35.091 [pool-1-thread-15] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Message received: deliveryTag=6, message={"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":6,"taskType":1,"serialNo":6,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:05:35.091 [pool-1-thread-15] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Added to rawHeartbeatMessages: deliveryTag=6, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":6,"serialNo":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:35.091 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Dispatching fresh tasks response: deliveryTag=6, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":6,"serialNo":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:35.092 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Takes a fresh tasks response: {"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":6,"serialNo":6,"status":"SUCCEEDED"}]}
2016-12-11 23:05:35.092 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to handle heartbeat: deliveryTag=6, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","taskId":6,"serialNo":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:35.092 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":6,"serialNo":6,"status":"SUCCEEDED"}
2016-12-11 23:05:35.092 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Get in-memory infos: taskInfo={"jobId":1,"taskId":6,"serialNo":6,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468726624}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}
2016-12-11 23:05:35.092 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":6,"serialNo":6,"status":"SUCCEEDED"}
2016-12-11 23:05:35.092 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:35.092 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:05:35.092 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2016-12-11 23:05:35.093 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:05:35.093 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:35.093 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=5, failedCount=0, runningTaskCount=0
2016-12-11 23:05:35.098 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=6, serialNo=6, resultCount=1423, updateTime=2016-12-11 23:05:35.093, taskStatus=SUCCEEDED
2016-12-11 23:05:35.103 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db job state changed: jobId=1, updateTime=2016-12-11 23:05:35.099
2016-12-11 23:05:35.104 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","lastUpdateTs":1481468735103,"taskId":6,"taskStatus":"SUCCEEDED","serialNo":6}
2016-12-11 23:05:35.105 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":6,"serialNo":6,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SUCCEEDED","lastUpdateTs":1481468735099}
2016-12-11 23:05:35.105 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=6, failedCount=0, runningTaskCount=0
2016-12-11 23:05:36.653 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468736642,"taskId":7,"taskStatus":"SCHEDULED","serialNo":7}
2016-12-11 23:05:36.654 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrenySchedulingStrategy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468736642,"taskId":7,"taskStatus":"SCHEDULED","serialNo":7}
2016-12-11 23:05:36.654 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:36.654 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:05:36.654 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=1/1) (taskType=GREEN_PLUM, occupied=0/1) 
2016-12-11 23:05:36.655 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:05:36.655 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:36.656 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to schedule: queue=q_user_job, taskType=JAVA_APPLICATION,  jobId=1, taskId=7, serialNo=7, taskType=Optional[JAVA_APPLICATION], taskCount=7
2016-12-11 23:05:36.663 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=7, serialNo=7, taskStatus=SCHEDULED
2016-12-11 23:05:36.663 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":7,"serialNo":7,"taskType":"JAVA_APPLICATION","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SCHEDULED","lastUpdateTs":1481468736663}
2016-12-11 23:05:36.664 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":7,"role":2,"serialNo":7,"taskCount":7,"params":"{\"taskDesc\":\"生成热力图数据\",\"hasIdMatch\":true,\"taskType\":2,\"handlerClass\":\"cn.shiyanjun.ddc.handler.HotMapTaskHander\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"city\":\"北京市\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap\"}"}
2016-12-11 23:05:36.665 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Redis state changed: queue=q_user_job, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468736664,"taskId":7,"taskStatus":"RUNNING","serialNo":7}
2016-12-11 23:05:36.668 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=7, serialNo=7, startTime=2016-12-11 23:05:36.665, updateTime=2016-12-11 23:05:36.665, taskStatus=RUNNING
2016-12-11 23:05:36.668 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}, task={"jobId":1,"taskId":7,"serialNo":7,"taskType":"JAVA_APPLICATION","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468736668}
2016-12-11 23:05:36.668 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=6, failedCount=0, runningTaskCount=1
2016-12-11 23:05:49.290 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2016-12-11 23:05:49.601 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":7,"taskType":2,"serialNo":7,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:05:49.602 [pool-1-thread-16] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Message received: deliveryTag=7, message={"type":"taskProgress","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","tasks":[{"jobId":1,"taskId":7,"taskType":2,"serialNo":7,"status":"SUCCEEDED","resultCount":"1423"}]}
2016-12-11 23:05:49.602 [pool-1-thread-16] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Added to rawHeartbeatMessages: deliveryTag=7, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","taskId":7,"serialNo":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:49.602 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Dispatching fresh tasks response: deliveryTag=7, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","taskId":7,"serialNo":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:49.602 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Takes a fresh tasks response: {"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","taskId":7,"serialNo":7,"status":"SUCCEEDED"}]}
2016-12-11 23:05:49.603 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Prepare to handle heartbeat: deliveryTag=7, heartbeatMessage={"platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","taskId":7,"serialNo":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2016-12-11 23:05:49.603 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Process task response: {"jobId":1,"taskType":2,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":7,"serialNo":7,"status":"SUCCEEDED"}
2016-12-11 23:05:49.603 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Get in-memory infos: taskInfo={"jobId":1,"taskId":7,"serialNo":7,"taskType":"JAVA_APPLICATION","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468736668}, jobInfo={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1481468631340}
2016-12-11 23:05:49.604 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task succeeded: {"jobId":1,"taskType":2,"resultCount":"1423","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskId":7,"serialNo":7,"status":"SUCCEEDED"}
2016-12-11 23:05:49.604 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:49.604 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |     CONCURRENCY STATUSES 
2016-12-11 23:05:49.605 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_user_job: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2016-12-11 23:05:49.605 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - |  queue=q_enterprise_job: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2016-12-11 23:05:49.605 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceMetadataManagerImpl - -------------------------------------------------------------------------
2016-12-11 23:05:49.605 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=6, failedCount=0, runningTaskCount=0
2016-12-11 23:05:49.610 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db task state changed: jobId=1, taskId=7, serialNo=7, resultCount=1423, updateTime=2016-12-11 23:05:49.605, taskStatus=SUCCEEDED
2016-12-11 23:05:49.618 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-db job state changed: jobId=1, updateTime=2016-12-11 23:05:49.611, jobStatus=SUCCEEDED
2016-12-11 23:05:49.618 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-memory job state changed: job={"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SUCCEEDED","lastUpdateTs":1481468749618}
2016-12-11 23:05:49.618 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Moving in-mem job: runningJobIdToInfos -> completedJobIdToInfos
2016-12-11 23:05:49.619 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-mem task removed: {"jobId":1,"taskId":1,"serialNo":1,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SUCCEEDED","lastUpdateTs":1481468669261}
2016-12-11 23:05:49.619 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-mem task removed: {"jobId":1,"taskId":2,"serialNo":2,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SUCCEEDED","lastUpdateTs":1481468690198}
2016-12-11 23:05:49.619 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-mem task removed: {"jobId":1,"taskId":3,"serialNo":3,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SUCCEEDED","lastUpdateTs":1481468704200}
2016-12-11 23:05:49.619 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-mem task removed: {"jobId":1,"taskId":4,"serialNo":4,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SUCCEEDED","lastUpdateTs":1481468717075}
2016-12-11 23:05:49.619 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-mem task removed: {"jobId":1,"taskId":5,"serialNo":5,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SUCCEEDED","lastUpdateTs":1481468724875}
2016-12-11 23:05:49.619 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-mem task removed: {"jobId":1,"taskId":6,"serialNo":6,"taskType":"GREEN_PLUM","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"SUCCEEDED","lastUpdateTs":1481468735099}
2016-12-11 23:05:49.620 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-mem task removed: {"jobId":1,"taskId":7,"serialNo":7,"taskType":"JAVA_APPLICATION","platform_id":"4e5cff3d8b9d4c2d89d8e9e64e78fdc3","taskStatus":"RUNNING","lastUpdateTs":1481468736668}
2016-12-11 23:05:49.620 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - In-mem job moved: {"jobId":1,"queue":"q_user_job","taskCount":7,"jobStatus":"SUCCEEDED","lastUpdateTs":1481468749618}
2016-12-11 23:05:49.620 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.DefaultSchedulingManager - Task counter changed: queue=q_user_job, succeededCount=7, failedCount=0, runningTaskCount=0
