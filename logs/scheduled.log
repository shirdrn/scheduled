2017-01-20 13:43:11.715 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=config.properties
2017-01-20 13:43:11.908 [main] INFO  cn.shiyanjun.platform.scheduled.ScheduledMain - Platform ID: ae2c26a57d20469ba079e8f4857cde00
2017-01-20 13:43:11.917 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=redis.properties
2017-01-20 13:43:12.004 [main] INFO  cn.shiyanjun.platform.scheduled.utils.ResourceUtils - Resource registered: config=redis.properties, resource=redis.clients.jedis.JedisPool@383534aa
2017-01-20 13:43:12.377 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2017-01-20 13:43:12.397 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configs: maxRecycleResourceCacheCapacity=10000
2017-01-20 13:43:12.429 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Configs: fetchJobInterval=3000, initialDelay=5000
2017-01-20 13:43:12.430 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Configs: maintenanceSegmentStartTime=03:00:00, maintenanceSegmentEndTime=03:15:00
2017-01-20 13:43:12.445 [main] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Configs: jobOrchestrateServiceUrl=http://127.0.0.1:8080/job/orchestrate
2017-01-20 13:43:12.446 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Protocol: jobOrchestrationProtocol=REST
2017-01-20 13:43:12.447 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Protocol: jobFetchProtocol=MYSQL
2017-01-20 13:43:12.461 [main] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Configs: isRecoveryFeatureEnabled=false
2017-01-20 13:43:12.462 [main] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Configs: keptHistoryJobMaxCount=200
2017-01-20 13:43:12.618 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/resource, servletClazz=cn.shiyanjun.platform.scheduled.rest.ResourceServlet
2017-01-20 13:43:12.619 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/queueing, servletClazz=cn.shiyanjun.platform.scheduled.rest.QueueingServlet
2017-01-20 13:43:12.622 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/scheduling, servletClazz=cn.shiyanjun.platform.scheduled.rest.SchedulingServlet
2017-01-20 13:43:12.624 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/maintenance, servletClazz=cn.shiyanjun.platform.scheduled.rest.MaintenanceServlet
2017-01-20 13:43:12.627 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/cancelJob, servletClazz=cn.shiyanjun.platform.scheduled.rest.CancelJobServlet
2017-01-20 13:43:12.627 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=queueings.properties
2017-01-20 13:43:12.665 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured task types: {user_job_queue=[JAVA_APPLICATION, GREEN_PLUM]}
2017-01-20 13:43:12.666 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured resources: {user_job_queue={JAVA_APPLICATION=1, GREEN_PLUM=1}}
2017-01-20 13:43:12.667 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured task types: {enterprise_job_queue=[JAVA_APPLICATION, GREEN_PLUM], user_job_queue=[JAVA_APPLICATION, GREEN_PLUM]}
2017-01-20 13:43:12.667 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured resources: {enterprise_job_queue={JAVA_APPLICATION=0, GREEN_PLUM=0}, user_job_queue={JAVA_APPLICATION=1, GREEN_PLUM=1}}
2017-01-20 13:43:12.827 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Start to read messages from MQ ...
2017-01-20 13:43:12.832 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Received msg: deliveryTag=1, message={"type":"taskProgress","platform_id":"a4427e9105004f118b56fdee9fca0b0f","tasks":[{"jobId":1,"taskId":1,"taskType":1,"seqNo":1,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:43:12.957 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Received msg: deliveryTag=2, message={"type":"taskProgress","platform_id":"a4427e9105004f118b56fdee9fca0b0f","tasks":[{"jobId":1,"taskId":2,"taskType":1,"seqNo":2,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:43:12.962 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Received msg: deliveryTag=3, message={"type":"taskProgress","platform_id":"a4427e9105004f118b56fdee9fca0b0f","tasks":[{"jobId":1,"taskId":3,"taskType":1,"seqNo":3,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:43:12.963 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Received msg: deliveryTag=4, message={"type":"taskProgress","platform_id":"a4427e9105004f118b56fdee9fca0b0f","tasks":[{"jobId":1,"taskId":4,"taskType":1,"seqNo":4,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:43:12.965 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Received msg: deliveryTag=5, message={"type":"taskProgress","platform_id":"a4427e9105004f118b56fdee9fca0b0f","tasks":[{"jobId":1,"taskId":5,"taskType":1,"seqNo":5,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:43:12.967 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Received msg: deliveryTag=6, message={"type":"taskProgress","platform_id":"a4427e9105004f118b56fdee9fca0b0f","tasks":[{"jobId":1,"taskId":6,"taskType":1,"seqNo":6,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:43:12.968 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Complete to read MQ messages: q=/scheduled/mq_heartbeat
2017-01-20 13:43:13.332 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Discard task response, due to job in db completed: jobId=1, jobStatus=FAILED, taskResponse={"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}
2017-01-20 13:43:13.332 [main] WARN  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Job already completed: taskResponse={"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}
2017-01-20 13:43:13.332 [main] WARN  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Job already completed: taskResponse={"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}
2017-01-20 13:43:13.333 [main] WARN  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Job already completed: taskResponse={"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}
2017-01-20 13:43:13.333 [main] WARN  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Job already completed: taskResponse={"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}
2017-01-20 13:43:13.333 [main] WARN  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Job already completed: taskResponse={"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}
2017-01-20 13:43:13.333 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Completed jobs: [1]
2017-01-20 13:43:13.334 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Pending recovery status: jobCount=0, jobs={}
2017-01-20 13:43:13.341 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Fetch job pool started: java.util.concurrent.Executors$DelegatedScheduledExecutorService@7748410a
2017-01-20 13:43:13.367 [SCHEDULED-003] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRunnableConsumer - Consumer started: consumerTag=amq.ctag-3n3DBYNJCcyDYz7LCcaS5w
2017-01-20 13:43:13.369 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/resource, servlet=cn.shiyanjun.platform.scheduled.rest.ResourceServlet@236e3f4e
2017-01-20 13:43:13.378 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/scheduling, servlet=cn.shiyanjun.platform.scheduled.rest.SchedulingServlet@1fb700ee
2017-01-20 13:43:13.382 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/queueing, servlet=cn.shiyanjun.platform.scheduled.rest.QueueingServlet@4a668b6e
2017-01-20 13:43:13.384 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/cancelJob, servlet=cn.shiyanjun.platform.scheduled.rest.CancelJobServlet@78ffe6dc
2017-01-20 13:43:13.385 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/maintenance, servlet=cn.shiyanjun.platform.scheduled.rest.MaintenanceServlet@76f2bbc1
2017-01-20 13:43:36.351 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Fetch jobs: count=1
2017-01-20 13:43:36.401 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Job fetched: jobId=1, fromStatus=SUBMITTED, toStatus=FETCHED
2017-01-20 13:43:36.401 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Job info: id=1, params={"conditions":[{"expType":"uploadFilter","exps":[{"inputId":"41","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705","expCode":"01000"}]},{"expType":"locationFilter","exps":[{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"},{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"},{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"}]},{"expType":"outputChart","exps":[{"city":"北京市","coordinateType":"1","endTime":"2016-41","startTime":"2016-41","timeType":"2","expCode":"04000"}]}],"excludeCheatedIds":0,"name":"test","outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output","outputType":3,"projectId":47}
2017-01-20 13:43:36.424 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Prepare to request job orchestrate service: Request{method=POST, url=http://127.0.0.1:8080/job/orchestrate/1/1, tag=null}
2017-01-20 13:43:36.613 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Responsed orchestrated job: {
	"jobId":1,
	"jobType":1,
	"stages":[
		{
			"stageLevel":0,
			"stageName":"FilterJobStage-0",
			"tasks":[
				{
					"expCode":"01000",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"上传设备ID条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/id?inputId=41&inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705&idRelationName=aa39fac7079e48859847cdcd2c678a17&outputBitmapKey=64443de4b9044f38812132330e2dc5a1\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputId\":\"41\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705\"}],\"expType\":\"uploadFilter\",\"expCode\":\"01000\"}",
					"priority":0,
					"seq":0,
					"seqNo":1,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":1,
			"stageName":"FilterJobStage-1",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=a4aed1cecc67432b9bddf6d6dadef512\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seq":0,
					"seqNo":2,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":2,
			"stageName":"FilterJobStage-2",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=adb0d053e06e416f9e6bc256110ab1ac\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seq":0,
					"seqNo":3,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":3,
			"stageName":"FilterJobStage-3",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=8199e5b804774ef8940ef6a697342ad0\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seq":0,
					"seqNo":4,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":4,
			"stageName":"MergeJobStage-4",
			"tasks":[
				{
					"expCode":"00000",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"中间结果合并筛选\",\"taskType\":\"1\",\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/calculate/bitmap?bitmapExp=64443de4b9044f38812132330e2dc5a1ANDa4aed1cecc67432b9bddf6d6dadef512ANDadb0d053e06e416f9e6bc256110ab1acAND8199e5b804774ef8940ef6a697342ad0&excludeCheatedIds=0&outputBitmapKey=65530d72cbb0403ab9350ba7cc35a603\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"expCode\":\"00000\"}",
					"priority":0,
					"seq":0,
					"seqNo":5,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":5,
			"stageName":"OutputJobStage-5",
			"tasks":[
				{
					"expCode":"04000",
					"jobId":1,
					"outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate",
					"parsedExpression":"{\"taskDesc\":\"输出聚集点明细\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/match/coordinate?inputBitmapKey=65530d72cbb0403ab9350ba7cc35a603&outputPath=/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate&idRelationName=aa39fac7079e48859847cdcd2c678a17&coordinateType=1&timeType=2&startTime=2016-41&endTime=2016-41\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"city\":\"北京市\",\"coordinateType\":\"1\",\"timeType\":\"2\",\"startTime\":\"2016-41\",\"endTime\":\"2016-41\"}],\"expType\":\"outputChart\",\"expCode\":\"04000\"}",
					"priority":0,
					"seq":0,
					"seqNo":6,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":6,
			"stageName":"OutputJobStage-6",
			"tasks":[
				{
					"expCode":"00002",
					"inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate",
					"jobId":1,
					"outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap",
					"parsedExpression":"{\"taskDesc\":\"生成热力图数据\",\"hasIdMatch\":true,\"taskType\":2,\"handlerClass\":\"cn.shiyanjun.ddc.handler.HotMapTaskHander\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"city\":\"北京市\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap\"}",
					"priority":0,
					"seq":0,
					"seqNo":7,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.HotMapTaskHander",
					"taskType":2
				}
			]
		}
	]
}
2017-01-20 13:43:36.644 [QUEUEING-WORKER] INFO  cn.shiyanjun.platform.scheduled.component.QueueingManagerImpl - Job queued: {"jobId":1,"jobStatus":"QUEUEING","taskCount":7,"taskId":-1,"seqNo":-1,"taskStatus":"CREATED","lastUpdateTs":1484891016642}
2017-01-20 13:43:38.419 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":1,"lastUpdateTs":1484891018408,"taskId":1,"taskStatus":"SCHEDULED"}
2017-01-20 13:43:38.420 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":1,"lastUpdateTs":1484891018408,"taskId":1,"taskStatus":"SCHEDULED"}
2017-01-20 13:43:38.420 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:43:38.420 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:43:38.422 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:43:38.422 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2017-01-20 13:43:38.422 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:43:38.423 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=1, seqNo=1, taskType=Optional[GREEN_PLUM], taskCount=7
2017-01-20 13:43:38.428 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2017-01-20 13:43:38.424, jobStatus=SCHEDULED
2017-01-20 13:43:38.431 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=1, seqNo=1, taskStatus=SCHEDULED
2017-01-20 13:43:38.433 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory job state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1484891018432}
2017-01-20 13:43:38.435 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1484891018432}, task={"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SCHEDULED","lastUpdateTs":1484891018432}
2017-01-20 13:43:38.438 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":1,"role":1,"seqNo":1,"taskCount":7,"params":"{\"taskDesc\":\"上传设备ID条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/id?inputId=41&inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705&idRelationName=aa39fac7079e48859847cdcd2c678a17&outputBitmapKey=64443de4b9044f38812132330e2dc5a1\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputId\":\"41\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705\"}],\"expType\":\"uploadFilter\",\"expCode\":\"01000\"}"}
2017-01-20 13:43:38.440 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":1,"lastUpdateTs":1484891018439,"taskId":1,"taskStatus":"RUNNING"}
2017-01-20 13:43:38.443 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2017-01-20 13:43:38.44, jobStatus=RUNNING
2017-01-20 13:43:38.448 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=1, seq=1, startTime=2017-01-20 13:43:38.444, updateTime=2017-01-20 13:43:38.444, taskStatus=RUNNING
2017-01-20 13:43:38.449 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory job state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}
2017-01-20 13:43:38.449 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891018449}
2017-01-20 13:43:38.451 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":0,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-01-20 13:43:45.852 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2017-01-20 13:43:46.124 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":1,"taskType":1,"seqNo":1,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:43:46.126 [pool-1-thread-10] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=1, message={"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":1,"taskType":1,"seqNo":1,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:43:46.128 [pool-1-thread-10] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=1, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:43:46.128 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=1, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:43:46.129 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}]}
2017-01-20 13:43:46.129 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=1, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:43:46.129 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":1,"status":"SUCCEEDED"}
2017-01-20 13:43:46.129 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891018449}, jobInfo={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}
2017-01-20 13:43:46.133 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":1,"status":"SUCCEEDED"}
2017-01-20 13:43:46.147 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=1, taskType=GREEN_PLUM
2017-01-20 13:43:46.147 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:43:46.147 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:43:46.147 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:43:46.148 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-01-20 13:43:46.148 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:43:46.148 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":0,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:43:46.153 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=1, seqNo=1, resultCount=1423, updateTime=2017-01-20 13:43:46.148, taskStatus=SUCCEEDED
2017-01-20 13:43:46.160 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2017-01-20 13:43:46.155
2017-01-20 13:43:46.161 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":1,"lastUpdateTs":1484891026160,"taskId":1,"taskStatus":"SUCCEEDED"}
2017-01-20 13:43:46.162 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SUCCEEDED","lastUpdateTs":1484891026155}
2017-01-20 13:43:46.162 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-01-20 13:43:46.162 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":1,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:43:48.486 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":2,"lastUpdateTs":1484891028480,"taskId":2,"taskStatus":"SCHEDULED"}
2017-01-20 13:43:48.487 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":2,"lastUpdateTs":1484891028480,"taskId":2,"taskStatus":"SCHEDULED"}
2017-01-20 13:43:48.487 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:43:48.488 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:43:48.488 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:43:48.489 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2017-01-20 13:43:48.489 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:43:48.490 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=2, seqNo=2, taskType=Optional[GREEN_PLUM], taskCount=7
2017-01-20 13:43:48.521 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=2, seqNo=2, taskStatus=SCHEDULED
2017-01-20 13:43:48.521 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SCHEDULED","lastUpdateTs":1484891028521}
2017-01-20 13:43:48.523 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":2,"role":1,"seqNo":2,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=a4aed1cecc67432b9bddf6d6dadef512\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2017-01-20 13:43:48.527 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":2,"lastUpdateTs":1484891028523,"taskId":2,"taskStatus":"RUNNING"}
2017-01-20 13:43:48.535 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=2, seq=2, startTime=2017-01-20 13:43:48.527, updateTime=2017-01-20 13:43:48.527, taskStatus=RUNNING
2017-01-20 13:43:48.536 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891028536}
2017-01-20 13:43:48.537 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":1,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-01-20 13:43:56.126 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":2,"taskType":1,"seqNo":2,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:43:56.128 [pool-1-thread-11] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=2, message={"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":2,"taskType":1,"seqNo":2,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:43:56.129 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=2, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:43:56.129 [pool-1-thread-11] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=2, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:43:56.130 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}]}
2017-01-20 13:43:56.133 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=2, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:43:56.136 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":2,"status":"SUCCEEDED"}
2017-01-20 13:43:56.137 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891028536}, jobInfo={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}
2017-01-20 13:43:56.138 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":2,"status":"SUCCEEDED"}
2017-01-20 13:43:56.138 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=2, taskType=GREEN_PLUM
2017-01-20 13:43:56.139 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:43:56.139 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:43:56.140 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:43:56.140 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-01-20 13:43:56.141 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:43:56.142 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":1,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:43:56.149 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=2, seqNo=2, resultCount=1423, updateTime=2017-01-20 13:43:56.142, taskStatus=SUCCEEDED
2017-01-20 13:43:56.159 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2017-01-20 13:43:56.153
2017-01-20 13:43:56.160 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":2,"lastUpdateTs":1484891036159,"taskId":2,"taskStatus":"SUCCEEDED"}
2017-01-20 13:43:56.161 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SUCCEEDED","lastUpdateTs":1484891036153}
2017-01-20 13:43:56.161 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-01-20 13:43:56.161 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":2,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:43:58.564 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":3,"lastUpdateTs":1484891038557,"taskId":3,"taskStatus":"SCHEDULED"}
2017-01-20 13:43:58.565 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":3,"lastUpdateTs":1484891038557,"taskId":3,"taskStatus":"SCHEDULED"}
2017-01-20 13:43:58.566 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:43:58.566 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:43:58.566 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:43:58.567 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2017-01-20 13:43:58.567 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:43:58.567 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=3, seqNo=3, taskType=Optional[GREEN_PLUM], taskCount=7
2017-01-20 13:43:58.584 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=3, seqNo=3, taskStatus=SCHEDULED
2017-01-20 13:43:58.584 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SCHEDULED","lastUpdateTs":1484891038584}
2017-01-20 13:43:58.585 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":3,"role":1,"seqNo":3,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=adb0d053e06e416f9e6bc256110ab1ac\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2017-01-20 13:43:58.588 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":3,"lastUpdateTs":1484891038586,"taskId":3,"taskStatus":"RUNNING"}
2017-01-20 13:43:58.593 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=3, seq=3, startTime=2017-01-20 13:43:58.588, updateTime=2017-01-20 13:43:58.588, taskStatus=RUNNING
2017-01-20 13:43:58.593 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891038593}
2017-01-20 13:43:58.594 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":2,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-01-20 13:44:06.129 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":3,"taskType":1,"seqNo":3,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:44:06.131 [pool-1-thread-12] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=3, message={"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":3,"taskType":1,"seqNo":3,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:44:06.133 [pool-1-thread-12] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=3, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:06.134 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=3, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:06.134 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}]}
2017-01-20 13:44:06.135 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=3, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:06.136 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":3,"status":"SUCCEEDED"}
2017-01-20 13:44:06.136 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891038593}, jobInfo={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}
2017-01-20 13:44:06.137 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":3,"status":"SUCCEEDED"}
2017-01-20 13:44:06.138 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=3, taskType=GREEN_PLUM
2017-01-20 13:44:06.138 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:06.138 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:44:06.138 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:44:06.139 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-01-20 13:44:06.139 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:06.139 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":2,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:44:06.147 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=3, seqNo=3, resultCount=1423, updateTime=2017-01-20 13:44:06.14, taskStatus=SUCCEEDED
2017-01-20 13:44:06.155 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2017-01-20 13:44:06.149
2017-01-20 13:44:06.158 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":3,"lastUpdateTs":1484891046155,"taskId":3,"taskStatus":"SUCCEEDED"}
2017-01-20 13:44:06.159 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SUCCEEDED","lastUpdateTs":1484891046149}
2017-01-20 13:44:06.159 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-01-20 13:44:06.160 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":3,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:44:08.621 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":4,"lastUpdateTs":1484891048615,"taskId":4,"taskStatus":"SCHEDULED"}
2017-01-20 13:44:08.622 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":4,"lastUpdateTs":1484891048615,"taskId":4,"taskStatus":"SCHEDULED"}
2017-01-20 13:44:08.622 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:08.623 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:44:08.623 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:44:08.624 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2017-01-20 13:44:08.624 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:08.624 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=4, seqNo=4, taskType=Optional[GREEN_PLUM], taskCount=7
2017-01-20 13:44:08.632 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=4, seqNo=4, taskStatus=SCHEDULED
2017-01-20 13:44:08.632 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SCHEDULED","lastUpdateTs":1484891048632}
2017-01-20 13:44:08.633 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":4,"role":1,"seqNo":4,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=8199e5b804774ef8940ef6a697342ad0\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2017-01-20 13:44:08.636 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":4,"lastUpdateTs":1484891048633,"taskId":4,"taskStatus":"RUNNING"}
2017-01-20 13:44:08.641 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=4, seq=4, startTime=2017-01-20 13:44:08.636, updateTime=2017-01-20 13:44:08.636, taskStatus=RUNNING
2017-01-20 13:44:08.641 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891048641}
2017-01-20 13:44:08.641 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":3,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-01-20 13:44:16.132 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":4,"taskType":1,"seqNo":4,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:44:16.134 [pool-1-thread-13] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=4, message={"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":4,"taskType":1,"seqNo":4,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:44:16.135 [pool-1-thread-13] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=4, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:16.136 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=4, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:16.137 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}]}
2017-01-20 13:44:16.137 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=4, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:16.138 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":4,"status":"SUCCEEDED"}
2017-01-20 13:44:16.138 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891048641}, jobInfo={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}
2017-01-20 13:44:16.139 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":4,"status":"SUCCEEDED"}
2017-01-20 13:44:16.139 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=4, taskType=GREEN_PLUM
2017-01-20 13:44:16.139 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:16.140 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:44:16.140 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:44:16.140 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-01-20 13:44:16.140 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:16.141 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":3,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:44:16.147 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=4, seqNo=4, resultCount=1423, updateTime=2017-01-20 13:44:16.141, taskStatus=SUCCEEDED
2017-01-20 13:44:16.154 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2017-01-20 13:44:16.15
2017-01-20 13:44:16.155 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":4,"lastUpdateTs":1484891056154,"taskId":4,"taskStatus":"SUCCEEDED"}
2017-01-20 13:44:16.155 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SUCCEEDED","lastUpdateTs":1484891056150}
2017-01-20 13:44:16.155 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-01-20 13:44:16.156 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":4,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:44:18.666 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":5,"lastUpdateTs":1484891058663,"taskId":5,"taskStatus":"SCHEDULED"}
2017-01-20 13:44:18.666 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":5,"lastUpdateTs":1484891058663,"taskId":5,"taskStatus":"SCHEDULED"}
2017-01-20 13:44:18.667 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:18.667 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:44:18.667 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:44:18.667 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2017-01-20 13:44:18.668 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:18.668 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=5, seqNo=5, taskType=Optional[GREEN_PLUM], taskCount=7
2017-01-20 13:44:18.675 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=5, seqNo=5, taskStatus=SCHEDULED
2017-01-20 13:44:18.675 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SCHEDULED","lastUpdateTs":1484891058675}
2017-01-20 13:44:18.676 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":5,"role":1,"seqNo":5,"taskCount":7,"params":"{\"taskDesc\":\"中间结果合并筛选\",\"taskType\":\"1\",\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/calculate/bitmap?bitmapExp=64443de4b9044f38812132330e2dc5a1ANDa4aed1cecc67432b9bddf6d6dadef512ANDadb0d053e06e416f9e6bc256110ab1acAND8199e5b804774ef8940ef6a697342ad0&excludeCheatedIds=0&outputBitmapKey=65530d72cbb0403ab9350ba7cc35a603\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"expCode\":\"00000\"}"}
2017-01-20 13:44:18.677 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":5,"lastUpdateTs":1484891058676,"taskId":5,"taskStatus":"RUNNING"}
2017-01-20 13:44:18.681 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=5, seq=5, startTime=2017-01-20 13:44:18.677, updateTime=2017-01-20 13:44:18.677, taskStatus=RUNNING
2017-01-20 13:44:18.682 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891058682}
2017-01-20 13:44:18.682 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":4,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-01-20 13:44:26.139 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":5,"taskType":1,"seqNo":5,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:44:26.140 [pool-1-thread-14] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=5, message={"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":5,"taskType":1,"seqNo":5,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:44:26.141 [pool-1-thread-14] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=5, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:26.141 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=5, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:26.142 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}]}
2017-01-20 13:44:26.143 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=5, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:26.143 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":5,"status":"SUCCEEDED"}
2017-01-20 13:44:26.144 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891058682}, jobInfo={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}
2017-01-20 13:44:26.144 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":5,"status":"SUCCEEDED"}
2017-01-20 13:44:26.145 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=5, taskType=GREEN_PLUM
2017-01-20 13:44:26.145 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:26.145 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:44:26.146 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:44:26.146 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-01-20 13:44:26.146 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:26.147 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":4,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:44:26.155 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=5, seqNo=5, resultCount=1423, updateTime=2017-01-20 13:44:26.147, taskStatus=SUCCEEDED
2017-01-20 13:44:26.167 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2017-01-20 13:44:26.159
2017-01-20 13:44:26.171 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":5,"lastUpdateTs":1484891066167,"taskId":5,"taskStatus":"SUCCEEDED"}
2017-01-20 13:44:26.171 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SUCCEEDED","lastUpdateTs":1484891066159}
2017-01-20 13:44:26.172 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-01-20 13:44:26.172 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":5,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:44:28.704 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":6,"lastUpdateTs":1484891068702,"taskId":6,"taskStatus":"SCHEDULED"}
2017-01-20 13:44:28.705 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":6,"lastUpdateTs":1484891068702,"taskId":6,"taskStatus":"SCHEDULED"}
2017-01-20 13:44:28.705 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:28.705 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:44:28.705 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:44:28.705 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=1/1) 
2017-01-20 13:44:28.706 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:28.706 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=6, seqNo=6, taskType=Optional[GREEN_PLUM], taskCount=7
2017-01-20 13:44:28.714 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=6, seqNo=6, taskStatus=SCHEDULED
2017-01-20 13:44:28.715 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SCHEDULED","lastUpdateTs":1484891068714}
2017-01-20 13:44:28.715 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":6,"role":1,"seqNo":6,"taskCount":7,"params":"{\"taskDesc\":\"输出聚集点明细\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/match/coordinate?inputBitmapKey=65530d72cbb0403ab9350ba7cc35a603&outputPath=/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate&idRelationName=aa39fac7079e48859847cdcd2c678a17&coordinateType=1&timeType=2&startTime=2016-41&endTime=2016-41\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"city\":\"北京市\",\"coordinateType\":\"1\",\"timeType\":\"2\",\"startTime\":\"2016-41\",\"endTime\":\"2016-41\"}],\"expType\":\"outputChart\",\"expCode\":\"04000\"}"}
2017-01-20 13:44:28.718 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":6,"lastUpdateTs":1484891068716,"taskId":6,"taskStatus":"RUNNING"}
2017-01-20 13:44:28.723 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=6, seq=6, startTime=2017-01-20 13:44:28.719, updateTime=2017-01-20 13:44:28.719, taskStatus=RUNNING
2017-01-20 13:44:28.723 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891068723}
2017-01-20 13:44:28.724 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":5,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-01-20 13:44:36.139 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":6,"taskType":1,"seqNo":6,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:44:36.140 [pool-1-thread-15] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=6, message={"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":6,"taskType":1,"seqNo":6,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:44:36.141 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=6, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:36.141 [pool-1-thread-15] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=6, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:36.141 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}]}
2017-01-20 13:44:36.141 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=6, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:36.142 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":6,"status":"SUCCEEDED"}
2017-01-20 13:44:36.142 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891068723}, jobInfo={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}
2017-01-20 13:44:36.142 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":6,"status":"SUCCEEDED"}
2017-01-20 13:44:36.142 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=6, taskType=GREEN_PLUM
2017-01-20 13:44:36.142 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:36.142 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:44:36.142 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:44:36.142 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-01-20 13:44:36.142 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:36.142 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":5,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:44:36.148 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=6, seqNo=6, resultCount=1423, updateTime=2017-01-20 13:44:36.143, taskStatus=SUCCEEDED
2017-01-20 13:44:36.154 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2017-01-20 13:44:36.149
2017-01-20 13:44:36.155 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":6,"lastUpdateTs":1484891076155,"taskId":6,"taskStatus":"SUCCEEDED"}
2017-01-20 13:44:36.156 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SUCCEEDED","lastUpdateTs":1484891076149}
2017-01-20 13:44:36.156 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-01-20 13:44:36.156 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":6,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:44:38.738 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":7,"lastUpdateTs":1484891078735,"taskId":7,"taskStatus":"SCHEDULED"}
2017-01-20 13:44:38.738 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":7,"lastUpdateTs":1484891078735,"taskId":7,"taskStatus":"SCHEDULED"}
2017-01-20 13:44:38.739 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:38.739 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:44:38.740 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:44:38.740 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=1/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-01-20 13:44:38.740 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:38.740 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=JAVA_APPLICATION,  jobId=1, taskId=7, seqNo=7, taskType=Optional[JAVA_APPLICATION], taskCount=7
2017-01-20 13:44:38.751 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=7, seqNo=7, taskStatus=SCHEDULED
2017-01-20 13:44:38.751 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":7,"seqNo":7,"taskType":"JAVA_APPLICATION","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SCHEDULED","lastUpdateTs":1484891078751}
2017-01-20 13:44:38.752 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":7,"role":2,"seqNo":7,"taskCount":7,"params":"{\"taskDesc\":\"生成热力图数据\",\"hasIdMatch\":true,\"taskType\":2,\"handlerClass\":\"cn.shiyanjun.ddc.handler.HotMapTaskHander\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"city\":\"北京市\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap\"}"}
2017-01-20 13:44:38.755 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":7,"lastUpdateTs":1484891078752,"taskId":7,"taskStatus":"RUNNING"}
2017-01-20 13:44:38.764 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=7, seq=7, startTime=2017-01-20 13:44:38.756, updateTime=2017-01-20 13:44:38.756, taskStatus=RUNNING
2017-01-20 13:44:38.764 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}, task={"jobId":1,"taskId":7,"seqNo":7,"taskType":"JAVA_APPLICATION","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891078764}
2017-01-20 13:44:38.765 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":6,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-01-20 13:44:46.142 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":7,"taskType":2,"seqNo":7,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:44:46.144 [pool-1-thread-16] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=7, message={"type":"taskProgress","platform_id":"ae2c26a57d20469ba079e8f4857cde00","tasks":[{"jobId":1,"taskId":7,"taskType":2,"seqNo":7,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-01-20 13:44:46.145 [pool-1-thread-16] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=7, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"taskId":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:46.145 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=7, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"taskId":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:46.146 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"taskId":7,"status":"SUCCEEDED"}]}
2017-01-20 13:44:46.146 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=7, heartbeatMessage={"platform_id":"ae2c26a57d20469ba079e8f4857cde00","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"taskId":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-01-20 13:44:46.146 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":7,"status":"SUCCEEDED"}
2017-01-20 13:44:46.147 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo={"jobId":1,"taskId":7,"seqNo":7,"taskType":"JAVA_APPLICATION","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891078764}, jobInfo={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1484891018448}
2017-01-20 13:44:46.147 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskId":7,"status":"SUCCEEDED"}
2017-01-20 13:44:46.148 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=7, taskType=JAVA_APPLICATION
2017-01-20 13:44:46.148 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:46.148 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-01-20 13:44:46.148 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=JAVA_APPLICATION, occupied=0/0) (taskType=GREEN_PLUM, occupied=0/0) 
2017-01-20 13:44:46.148 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=JAVA_APPLICATION, occupied=0/1) (taskType=GREEN_PLUM, occupied=0/1) 
2017-01-20 13:44:46.148 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-01-20 13:44:46.149 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":6,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-01-20 13:44:46.155 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db task state changed: jobId=1, taskId=7, seqNo=7, resultCount=1423, updateTime=2017-01-20 13:44:46.149, taskStatus=SUCCEEDED
2017-01-20 13:44:46.165 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-db job state changed: jobId=1, updateTime=2017-01-20 13:44:46.158, jobStatus=SUCCEEDED
2017-01-20 13:44:46.165 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory job state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SUCCEEDED","lastUpdateTs":1484891086165}
2017-01-20 13:44:46.166 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Moving in-mem job: runningJobIdToInfos -> completedJobIdToInfos
2017-01-20 13:44:46.168 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SUCCEEDED","lastUpdateTs":1484891026155}
2017-01-20 13:44:46.169 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SUCCEEDED","lastUpdateTs":1484891036153}
2017-01-20 13:44:46.169 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SUCCEEDED","lastUpdateTs":1484891046149}
2017-01-20 13:44:46.169 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SUCCEEDED","lastUpdateTs":1484891056150}
2017-01-20 13:44:46.170 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SUCCEEDED","lastUpdateTs":1484891066159}
2017-01-20 13:44:46.170 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"SUCCEEDED","lastUpdateTs":1484891076149}
2017-01-20 13:44:46.170 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem task removed: {"jobId":1,"taskId":7,"seqNo":7,"taskType":"JAVA_APPLICATION","platform_id":"ae2c26a57d20469ba079e8f4857cde00","taskStatus":"RUNNING","lastUpdateTs":1484891078764}
2017-01-20 13:44:46.171 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-mem job moved: {"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SUCCEEDED","lastUpdateTs":1484891086165}
2017-01-20 13:44:46.171 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":1,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-01-20 13:44:46.171 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":7,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
