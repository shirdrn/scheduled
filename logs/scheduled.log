2017-04-16 23:40:42.511 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=config.properties
2017-04-16 23:40:42.828 [main] INFO  cn.shiyanjun.platform.scheduled.ScheduledMain - Platform ID: ec39850be9184217889ba7c193af5e40
2017-04-16 23:40:42.841 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=redis.properties
2017-04-16 23:40:42.965 [main] INFO  cn.shiyanjun.platform.scheduled.utils.ResourceUtils - Resource registered: config=redis.properties, resource=redis.clients.jedis.JedisPool@383534aa
2017-04-16 23:40:43.583 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2017-04-16 23:40:43.623 [main] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Configs: keptHistoryJobMaxCount=200
2017-04-16 23:40:43.625 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configs: maxRecycleResourceCacheCapacity=10000
2017-04-16 23:40:43.677 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Configs: fetchJobInterval=3000, initialDelay=5000
2017-04-16 23:40:43.677 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Configs: maintenanceSegmentStartTime=03:00:00, maintenanceSegmentEndTime=03:15:00
2017-04-16 23:40:43.964 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/resource, servletClazz=cn.shiyanjun.platform.scheduled.rest.ResourceServlet
2017-04-16 23:40:43.965 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/queueing, servletClazz=cn.shiyanjun.platform.scheduled.rest.QueueingServlet
2017-04-16 23:40:43.965 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/scheduling, servletClazz=cn.shiyanjun.platform.scheduled.rest.SchedulingServlet
2017-04-16 23:40:43.966 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/maintenance, servletClazz=cn.shiyanjun.platform.scheduled.rest.MaintenanceServlet
2017-04-16 23:40:43.968 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet registered: path=/admin/cancelJob, servletClazz=cn.shiyanjun.platform.scheduled.rest.CancelJobServlet
2017-04-16 23:40:43.975 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=queueings.properties
2017-04-16 23:40:44.000 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured task types: {user_job_queue=[GREEN_PLUM, JAVA_APPLICATION]}
2017-04-16 23:40:44.001 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured resources: {user_job_queue={GREEN_PLUM=1, JAVA_APPLICATION=1}}
2017-04-16 23:40:44.006 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured task types: {enterprise_job_queue=[GREEN_PLUM, JAVA_APPLICATION], user_job_queue=[GREEN_PLUM, JAVA_APPLICATION]}
2017-04-16 23:40:44.007 [main] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Configured resources: {enterprise_job_queue={GREEN_PLUM=0, JAVA_APPLICATION=0}, user_job_queue={GREEN_PLUM=1, JAVA_APPLICATION=1}}
2017-04-16 23:40:44.147 [main] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Configs: jobOrchestrateServiceUrl=http://127.0.0.1:8080/job/orchestrate
2017-04-16 23:40:44.147 [main] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Configs: jobOrchestrateServiceUrl=http://127.0.0.1:7070/service/orchestrate
2017-04-16 23:40:44.148 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Protocol: jobOrchestrationProtocol=REST
2017-04-16 23:40:44.149 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Protocol: jobFetchProtocol=MYSQL
2017-04-16 23:40:44.156 [main] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Fetch job pool started: java.util.concurrent.Executors$DelegatedScheduledExecutorService@48aaecc3
2017-04-16 23:40:44.163 [main] INFO  cn.shiyanjun.platform.scheduled.component.SimpleTaskResponseHandlingController - Configs: isRecoveryFeatureEnabled=false
2017-04-16 23:40:44.175 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Start to read messages from MQ ...
2017-04-16 23:40:44.178 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Complete to read MQ messages: q=/scheduled/mq_heartbeat
2017-04-16 23:40:44.226 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Completed jobs: []
2017-04-16 23:40:44.228 [main] INFO  cn.shiyanjun.platform.scheduled.component.RecoveryManagerImpl - Pending recovery status: jobCount=0, jobs={}
2017-04-16 23:40:44.713 [main] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Update in-db job: jobId=1, currentStatus=RUNNING, targetStatus=FAILED
2017-04-16 23:40:44.730 [SCHEDULED-003] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRunnableConsumer - Consumer started: consumerTag=amq.ctag-LqYP-d8g4LEoaySTQUvfDg
2017-04-16 23:40:44.732 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/resource, servlet=cn.shiyanjun.platform.scheduled.rest.ResourceServlet@7bedc48a
2017-04-16 23:40:44.743 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/scheduling, servlet=cn.shiyanjun.platform.scheduled.rest.SchedulingServlet@22fcf7ab
2017-04-16 23:40:44.743 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/queueing, servlet=cn.shiyanjun.platform.scheduled.rest.QueueingServlet@63475ace
2017-04-16 23:40:44.744 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/cancelJob, servlet=cn.shiyanjun.platform.scheduled.rest.CancelJobServlet@c0c2f8d
2017-04-16 23:40:44.744 [main] INFO  cn.shiyanjun.platform.scheduled.common.AbstractRestServer - Servlet instance created: path=/admin/maintenance, servlet=cn.shiyanjun.platform.scheduled.rest.MaintenanceServlet@6913c1fb
2017-04-16 23:41:07.165 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Fetch jobs: count=1
2017-04-16 23:41:07.181 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-04-16 23:41:07.166, jobStatus=FETCHED
2017-04-16 23:41:07.183 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Job fetched: jobId=1, fromStatus=SUBMITTED, toStatus=FETCHED
2017-04-16 23:41:07.186 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.component.ScheduledJobFetcher - Job info: id=1, params={"conditions":[{"expType":"uploadFilter","exps":[{"inputId":"41","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705","expCode":"01000"}]},{"expType":"locationFilter","exps":[{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"},{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"},{"coordinateType":2,"endTime":"2016-10-07","hourSegments":"0-23","inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318","startTime":"2016-10-01","timeType":"1","uploadType":"3","expCode":"01012"}]},{"expType":"outputChart","exps":[{"city":"北京市","coordinateType":"1","endTime":"2016-41","startTime":"2016-41","timeType":"2","expCode":"04000"}]}],"excludeCheatedIds":0,"name":"test","outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output","outputType":3,"projectId":47}
2017-04-16 23:41:07.224 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Prepare to request job orchestrate service: Request{method=POST, url=http://127.0.0.1:8080/job/orchestrate/1/1, tag=null}
2017-04-16 23:41:07.655 [JOB-FETCHER-001] INFO  cn.shiyanjun.platform.scheduled.protocols.JobOrchestrationProtocolManager - Responsed orchestrated job: {
	"jobId":1,
	"jobType":1,
	"stages":[
		{
			"stageLevel":0,
			"stageName":"FilterJobStage-0",
			"tasks":[
				{
					"expCode":"01000",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"上传设备ID条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/id?inputId=41&inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705&idRelationName=0084212b2ba54429951b296ad37990ef&outputBitmapKey=732677fd76d24c839203fdd6e1f5673f\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputId\":\"41\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705\"}],\"expType\":\"uploadFilter\",\"expCode\":\"01000\"}",
					"priority":0,
					"seq":0,
					"seqNo":1,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":1,
			"stageName":"FilterJobStage-1",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=bf77e987a9964657a9ec39b41feaece2\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seq":0,
					"seqNo":2,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":2,
			"stageName":"FilterJobStage-2",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=1b2ea9c3a2b8433db3f4292d731cb7d3\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seq":0,
					"seqNo":3,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":3,
			"stageName":"FilterJobStage-3",
			"tasks":[
				{
					"expCode":"01012",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=c8c088e586504409845f0d1c61f15849\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}",
					"priority":0,
					"seq":0,
					"seqNo":4,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":4,
			"stageName":"MergeJobStage-4",
			"tasks":[
				{
					"expCode":"00000",
					"jobId":1,
					"parsedExpression":"{\"taskDesc\":\"中间结果合并筛选\",\"taskType\":\"1\",\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/calculate/bitmap?bitmapExp=732677fd76d24c839203fdd6e1f5673fANDbf77e987a9964657a9ec39b41feaece2AND1b2ea9c3a2b8433db3f4292d731cb7d3ANDc8c088e586504409845f0d1c61f15849&excludeCheatedIds=0&outputBitmapKey=8e19cb2ebb1440f5a353d32b5a93e907\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"expCode\":\"00000\"}",
					"priority":0,
					"seq":0,
					"seqNo":5,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":5,
			"stageName":"OutputJobStage-5",
			"tasks":[
				{
					"expCode":"04000",
					"jobId":1,
					"outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate",
					"parsedExpression":"{\"taskDesc\":\"输出聚集点明细\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/match/coordinate?inputBitmapKey=8e19cb2ebb1440f5a353d32b5a93e907&outputPath=/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate&idRelationName=0084212b2ba54429951b296ad37990ef&coordinateType=1&timeType=2&startTime=2016-41&endTime=2016-41\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"city\":\"北京市\",\"coordinateType\":\"1\",\"timeType\":\"2\",\"startTime\":\"2016-41\",\"endTime\":\"2016-41\"}],\"expType\":\"outputChart\",\"expCode\":\"04000\"}",
					"priority":0,
					"seq":0,
					"seqNo":6,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.GPTaskHandler",
					"taskType":1
				}
			]
		},
		{
			"stageLevel":6,
			"stageName":"OutputJobStage-6",
			"tasks":[
				{
					"expCode":"00002",
					"inputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate",
					"jobId":1,
					"outputPath":"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap",
					"parsedExpression":"{\"taskDesc\":\"生成热力图数据\",\"hasIdMatch\":true,\"taskType\":2,\"handlerClass\":\"cn.shiyanjun.ddc.handler.HotMapTaskHander\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"city\":\"北京市\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap\"}",
					"priority":0,
					"seq":0,
					"seqNo":7,
					"taskHandlerClass":"cn.shiyanjun.ddc.handler.HotMapTaskHander",
					"taskType":2
				}
			]
		}
	]
}
2017-04-16 23:41:07.824 [QUEUEING] INFO  cn.shiyanjun.platform.scheduled.component.QueueingManagerImpl - Job queued: {"jobId":1,"jobStatus":"QUEUEING","taskCount":7,"taskId":-1,"seqNo":-1,"taskStatus":"CREATED","lastUpdateTs":1492357267791}
2017-04-16 23:41:07.847 [QUEUEING] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-04-16 23:41:07.825, jobStatus=QUEUEING
2017-04-16 23:41:07.861 [QUEUEING] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: taskId=1, updateTime=2017-04-16 23:41:07.848, taskStatus=QUEUEING
2017-04-16 23:41:07.874 [QUEUEING] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: taskId=2, updateTime=2017-04-16 23:41:07.862, taskStatus=QUEUEING
2017-04-16 23:41:07.887 [QUEUEING] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: taskId=3, updateTime=2017-04-16 23:41:07.874, taskStatus=QUEUEING
2017-04-16 23:41:07.895 [QUEUEING] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: taskId=4, updateTime=2017-04-16 23:41:07.889, taskStatus=QUEUEING
2017-04-16 23:41:07.902 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":1,"lastUpdateTs":1492357267871,"taskId":1,"taskStatus":"SCHEDULED"}
2017-04-16 23:41:07.905 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":1,"lastUpdateTs":1492357267871,"taskId":1,"taskStatus":"SCHEDULED"}
2017-04-16 23:41:07.905 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:07.906 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:41:07.909 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:41:07.910 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=1/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:41:07.910 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:07.911 [QUEUEING] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: taskId=5, updateTime=2017-04-16 23:41:07.895, taskStatus=QUEUEING
2017-04-16 23:41:07.912 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=1, seqNo=1, taskType=Optional[GREEN_PLUM], taskCount=7
2017-04-16 23:41:07.922 [QUEUEING] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: taskId=6, updateTime=2017-04-16 23:41:07.911, taskStatus=QUEUEING
2017-04-16 23:41:07.926 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-04-16 23:41:07.914, jobStatus=SCHEDULED
2017-04-16 23:41:07.929 [QUEUEING] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: taskId=7, updateTime=2017-04-16 23:41:07.922, taskStatus=QUEUEING
2017-04-16 23:41:07.936 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=1, seqNo=1, taskStatus=SCHEDULED
2017-04-16 23:41:07.938 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory job state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1492357267937}
2017-04-16 23:41:07.939 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1492357267937}, task={"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SCHEDULED","lastUpdateTs":1492357267937}
2017-04-16 23:41:07.941 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":1,"role":1,"seqNo":1,"taskCount":7,"params":"{\"taskDesc\":\"上传设备ID条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/id?inputId=41&inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705&idRelationName=0084212b2ba54429951b296ad37990ef&outputBitmapKey=732677fd76d24c839203fdd6e1f5673f\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputId\":\"41\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/1476943956705\"}],\"expType\":\"uploadFilter\",\"expCode\":\"01000\"}"}
2017-04-16 23:41:07.945 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":1,"lastUpdateTs":1492357267943,"taskId":1,"taskStatus":"RUNNING"}
2017-04-16 23:41:07.953 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-04-16 23:41:07.946, jobStatus=RUNNING
2017-04-16 23:41:07.962 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=1, seq=1, startTime=2017-04-16 23:41:07.954, updateTime=2017-04-16 23:41:07.954, taskStatus=RUNNING
2017-04-16 23:41:07.962 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory job state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}
2017-04-16 23:41:07.962 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357267962}
2017-04-16 23:41:07.970 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":0,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-04-16 23:41:25.415 [main] INFO  cn.shiyanjun.platform.api.common.ContextImpl - Load configuration file: config=rabbitmq.properties
2017-04-16 23:41:26.052 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":1,"taskType":1,"seqNo":1,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:41:26.056 [pool-1-thread-10] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=1, message={"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":1,"taskType":1,"seqNo":1,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:41:26.059 [pool-1-thread-10] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=1, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:41:26.059 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=1, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:41:26.060 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}]}
2017-04-16 23:41:26.060 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=1, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"taskId":1,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:41:26.060 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":1,"status":"SUCCEEDED"}
2017-04-16 23:41:26.061 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357267962}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}]
2017-04-16 23:41:26.076 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":1,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":1,"status":"SUCCEEDED"}
2017-04-16 23:41:26.083 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=1, taskType=GREEN_PLUM
2017-04-16 23:41:26.084 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:26.085 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:41:26.085 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:41:26.085 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:41:26.085 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:26.086 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":0,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:41:26.092 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: , taskId=1, resultCount=1423, updateTime=2017-04-16 23:41:26.087, taskStatus=SUCCEEDED
2017-04-16 23:41:26.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-04-16 23:41:26.095, jobStatus=RUNNING
2017-04-16 23:41:26.110 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":1,"lastUpdateTs":1492357286107,"taskId":1,"taskStatus":"SUCCEEDED"}
2017-04-16 23:41:26.111 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SUCCEEDED","lastUpdateTs":1492357286095}
2017-04-16 23:41:26.111 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-04-16 23:41:26.112 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":1,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:41:28.041 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":2,"lastUpdateTs":1492357288029,"taskId":2,"taskStatus":"SCHEDULED"}
2017-04-16 23:41:28.042 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":2,"lastUpdateTs":1492357288029,"taskId":2,"taskStatus":"SCHEDULED"}
2017-04-16 23:41:28.042 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:28.043 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:41:28.043 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:41:28.043 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=1/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:41:28.044 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:28.044 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=2, seqNo=2, taskType=Optional[GREEN_PLUM], taskCount=7
2017-04-16 23:41:28.057 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=2, seqNo=2, taskStatus=SCHEDULED
2017-04-16 23:41:28.057 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SCHEDULED","lastUpdateTs":1492357288057}
2017-04-16 23:41:28.057 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":2,"role":1,"seqNo":2,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=bf77e987a9964657a9ec39b41feaece2\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1258\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2017-04-16 23:41:28.061 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":2,"lastUpdateTs":1492357288059,"taskId":2,"taskStatus":"RUNNING"}
2017-04-16 23:41:28.071 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=2, seq=2, startTime=2017-04-16 23:41:28.061, updateTime=2017-04-16 23:41:28.061, taskStatus=RUNNING
2017-04-16 23:41:28.072 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357288071}
2017-04-16 23:41:28.072 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":1,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-04-16 23:41:36.054 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":2,"taskType":1,"seqNo":2,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:41:36.057 [pool-1-thread-11] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=2, message={"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":2,"taskType":1,"seqNo":2,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:41:36.059 [pool-1-thread-11] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=2, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:41:36.060 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=2, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:41:36.061 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}]}
2017-04-16 23:41:36.062 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=2, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"taskId":2,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:41:36.064 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":2,"status":"SUCCEEDED"}
2017-04-16 23:41:36.068 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357288071}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}]
2017-04-16 23:41:36.069 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":2,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":2,"status":"SUCCEEDED"}
2017-04-16 23:41:36.070 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=2, taskType=GREEN_PLUM
2017-04-16 23:41:36.071 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:36.071 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:41:36.072 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:41:36.073 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:41:36.073 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:36.074 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":1,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:41:36.092 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: , taskId=2, resultCount=1423, updateTime=2017-04-16 23:41:36.075, taskStatus=SUCCEEDED
2017-04-16 23:41:36.104 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-04-16 23:41:36.094, jobStatus=RUNNING
2017-04-16 23:41:36.106 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":2,"lastUpdateTs":1492357296104,"taskId":2,"taskStatus":"SUCCEEDED"}
2017-04-16 23:41:36.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SUCCEEDED","lastUpdateTs":1492357296094}
2017-04-16 23:41:36.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-04-16 23:41:36.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":2,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:41:44.134 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":3,"lastUpdateTs":1492357304124,"taskId":3,"taskStatus":"SCHEDULED"}
2017-04-16 23:41:44.135 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":3,"lastUpdateTs":1492357304124,"taskId":3,"taskStatus":"SCHEDULED"}
2017-04-16 23:41:44.135 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:44.135 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:41:44.135 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:41:44.135 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=1/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:41:44.135 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:44.136 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=3, seqNo=3, taskType=Optional[GREEN_PLUM], taskCount=7
2017-04-16 23:41:44.145 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=3, seqNo=3, taskStatus=SCHEDULED
2017-04-16 23:41:44.151 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SCHEDULED","lastUpdateTs":1492357304150}
2017-04-16 23:41:44.154 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":3,"role":1,"seqNo":3,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=1b2ea9c3a2b8433db3f4292d731cb7d3\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2017-04-16 23:41:44.160 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":3,"lastUpdateTs":1492357304157,"taskId":3,"taskStatus":"RUNNING"}
2017-04-16 23:41:44.171 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=3, seq=3, startTime=2017-04-16 23:41:44.16, updateTime=2017-04-16 23:41:44.16, taskStatus=RUNNING
2017-04-16 23:41:44.171 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357304171}
2017-04-16 23:41:44.171 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":2,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-04-16 23:41:46.058 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":3,"taskType":1,"seqNo":3,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:41:46.060 [pool-1-thread-12] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=3, message={"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":3,"taskType":1,"seqNo":3,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:41:46.063 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=3, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:41:46.065 [pool-1-thread-12] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=3, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:41:46.068 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}]}
2017-04-16 23:41:46.068 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=3, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"taskId":3,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:41:46.069 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":3,"status":"SUCCEEDED"}
2017-04-16 23:41:46.071 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357304171}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}]
2017-04-16 23:41:46.072 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":3,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":3,"status":"SUCCEEDED"}
2017-04-16 23:41:46.073 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=3, taskType=GREEN_PLUM
2017-04-16 23:41:46.073 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:46.073 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:41:46.073 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:41:46.074 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:41:46.074 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:46.075 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":2,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:41:46.083 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: , taskId=3, resultCount=1423, updateTime=2017-04-16 23:41:46.075, taskStatus=SUCCEEDED
2017-04-16 23:41:46.091 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-04-16 23:41:46.086, jobStatus=RUNNING
2017-04-16 23:41:46.093 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":3,"lastUpdateTs":1492357306091,"taskId":3,"taskStatus":"SUCCEEDED"}
2017-04-16 23:41:46.093 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SUCCEEDED","lastUpdateTs":1492357306086}
2017-04-16 23:41:46.094 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-04-16 23:41:46.094 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":3,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:41:47.200 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":4,"lastUpdateTs":1492357307191,"taskId":4,"taskStatus":"SCHEDULED"}
2017-04-16 23:41:47.200 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":4,"lastUpdateTs":1492357307191,"taskId":4,"taskStatus":"SCHEDULED"}
2017-04-16 23:41:47.201 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:47.201 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:41:47.201 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:41:47.202 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=1/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:41:47.202 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:47.202 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=4, seqNo=4, taskType=Optional[GREEN_PLUM], taskCount=7
2017-04-16 23:41:47.209 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=4, seqNo=4, taskStatus=SCHEDULED
2017-04-16 23:41:47.210 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SCHEDULED","lastUpdateTs":1492357307210}
2017-04-16 23:41:47.212 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":4,"role":1,"seqNo":4,"taskCount":7,"params":"{\"taskDesc\":\"位置条件筛选\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/mapping/enclosure?inputPath=/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318&uploadType=3&coordinateType=2&timeType=1&startTime=2016-10-01&endTime=2016-10-07&hourSegments=0-23&outputBitmapKey=c8c088e586504409845f0d1c61f15849\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/upload/geo_fence_1318\",\"uploadType\":\"3\",\"coordinateType\":2,\"timeType\":\"1\",\"startTime\":\"2016-10-01\",\"endTime\":\"2016-10-07\",\"hourSegments\":\"0-23\"}],\"expType\":\"locationFilter\",\"expCode\":\"01012\"}"}
2017-04-16 23:41:47.225 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":4,"lastUpdateTs":1492357307223,"taskId":4,"taskStatus":"RUNNING"}
2017-04-16 23:41:47.234 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=4, seq=4, startTime=2017-04-16 23:41:47.226, updateTime=2017-04-16 23:41:47.226, taskStatus=RUNNING
2017-04-16 23:41:47.235 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357307235}
2017-04-16 23:41:47.235 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":3,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-04-16 23:41:56.062 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":4,"taskType":1,"seqNo":4,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:41:56.067 [pool-1-thread-13] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=4, message={"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":4,"taskType":1,"seqNo":4,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:41:56.068 [pool-1-thread-13] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=4, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:41:56.068 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=4, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:41:56.069 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}]}
2017-04-16 23:41:56.070 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=4, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"taskId":4,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:41:56.070 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":4,"status":"SUCCEEDED"}
2017-04-16 23:41:56.071 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357307235}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}]
2017-04-16 23:41:56.072 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":4,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":4,"status":"SUCCEEDED"}
2017-04-16 23:41:56.073 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=4, taskType=GREEN_PLUM
2017-04-16 23:41:56.073 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:56.073 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:41:56.074 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:41:56.074 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:41:56.074 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:56.075 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":3,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:41:56.088 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: , taskId=4, resultCount=1423, updateTime=2017-04-16 23:41:56.075, taskStatus=SUCCEEDED
2017-04-16 23:41:56.101 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-04-16 23:41:56.093, jobStatus=RUNNING
2017-04-16 23:41:56.103 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":4,"lastUpdateTs":1492357316102,"taskId":4,"taskStatus":"SUCCEEDED"}
2017-04-16 23:41:56.103 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SUCCEEDED","lastUpdateTs":1492357316093}
2017-04-16 23:41:56.104 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-04-16 23:41:56.104 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":4,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:41:57.280 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":5,"lastUpdateTs":1492357317271,"taskId":5,"taskStatus":"SCHEDULED"}
2017-04-16 23:41:57.282 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":5,"lastUpdateTs":1492357317271,"taskId":5,"taskStatus":"SCHEDULED"}
2017-04-16 23:41:57.283 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:57.283 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:41:57.284 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:41:57.284 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=1/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:41:57.284 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:41:57.285 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=5, seqNo=5, taskType=Optional[GREEN_PLUM], taskCount=7
2017-04-16 23:41:57.293 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=5, seqNo=5, taskStatus=SCHEDULED
2017-04-16 23:41:57.296 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SCHEDULED","lastUpdateTs":1492357317294}
2017-04-16 23:41:57.300 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":5,"role":1,"seqNo":5,"taskCount":7,"params":"{\"taskDesc\":\"中间结果合并筛选\",\"taskType\":\"1\",\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/calculate/bitmap?bitmapExp=732677fd76d24c839203fdd6e1f5673fANDbf77e987a9964657a9ec39b41feaece2AND1b2ea9c3a2b8433db3f4292d731cb7d3ANDc8c088e586504409845f0d1c61f15849&excludeCheatedIds=0&outputBitmapKey=8e19cb2ebb1440f5a353d32b5a93e907\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"expCode\":\"00000\"}"}
2017-04-16 23:41:57.306 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":5,"lastUpdateTs":1492357317304,"taskId":5,"taskStatus":"RUNNING"}
2017-04-16 23:41:57.310 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=5, seq=5, startTime=2017-04-16 23:41:57.306, updateTime=2017-04-16 23:41:57.306, taskStatus=RUNNING
2017-04-16 23:41:57.310 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357317310}
2017-04-16 23:41:57.311 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":4,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-04-16 23:42:06.068 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":5,"taskType":1,"seqNo":5,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:42:06.070 [pool-1-thread-14] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=5, message={"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":5,"taskType":1,"seqNo":5,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:42:06.072 [pool-1-thread-14] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=5, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:42:06.072 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=5, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:42:06.073 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}]}
2017-04-16 23:42:06.074 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=5, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"taskId":5,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:42:06.074 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":5,"status":"SUCCEEDED"}
2017-04-16 23:42:06.075 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357317310}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}]
2017-04-16 23:42:06.079 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":5,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":5,"status":"SUCCEEDED"}
2017-04-16 23:42:06.082 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=5, taskType=GREEN_PLUM
2017-04-16 23:42:06.083 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:42:06.083 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:42:06.083 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:42:06.084 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:42:06.084 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:42:06.084 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":4,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:42:06.099 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: , taskId=5, resultCount=1423, updateTime=2017-04-16 23:42:06.084, taskStatus=SUCCEEDED
2017-04-16 23:42:06.115 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-04-16 23:42:06.104, jobStatus=RUNNING
2017-04-16 23:42:06.117 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":5,"lastUpdateTs":1492357326115,"taskId":5,"taskStatus":"SUCCEEDED"}
2017-04-16 23:42:06.118 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SUCCEEDED","lastUpdateTs":1492357326104}
2017-04-16 23:42:06.118 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-04-16 23:42:06.118 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":5,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:42:06.357 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":6,"lastUpdateTs":1492357326354,"taskId":6,"taskStatus":"SCHEDULED"}
2017-04-16 23:42:06.357 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":6,"lastUpdateTs":1492357326354,"taskId":6,"taskStatus":"SCHEDULED"}
2017-04-16 23:42:06.357 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:42:06.357 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:42:06.357 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:42:06.357 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=1/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:42:06.357 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:42:06.358 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=GREEN_PLUM,  jobId=1, taskId=6, seqNo=6, taskType=Optional[GREEN_PLUM], taskCount=7
2017-04-16 23:42:06.364 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=6, seqNo=6, taskStatus=SCHEDULED
2017-04-16 23:42:06.365 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SCHEDULED","lastUpdateTs":1492357326364}
2017-04-16 23:42:06.365 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":6,"role":1,"seqNo":6,"taskCount":7,"params":"{\"taskDesc\":\"输出聚集点明细\",\"taskType\":1,\"handlerClass\":\"cn.shiyanjun.ddc.handler.GPTaskHandler\",\"requestUrl\":\"http://172.21.58.17:8080/api/gp/match/coordinate?inputBitmapKey=8e19cb2ebb1440f5a353d32b5a93e907&outputPath=/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate&idRelationName=0084212b2ba54429951b296ad37990ef&coordinateType=1&timeType=2&startTime=2016-41&endTime=2016-41\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"pollUrl\":\"http://172.21.58.17:8080/api/task/status\",\"exps\":[{\"city\":\"北京市\",\"coordinateType\":\"1\",\"timeType\":\"2\",\"startTime\":\"2016-41\",\"endTime\":\"2016-41\"}],\"expType\":\"outputChart\",\"expCode\":\"04000\"}"}
2017-04-16 23:42:06.368 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":6,"lastUpdateTs":1492357326366,"taskId":6,"taskStatus":"RUNNING"}
2017-04-16 23:42:06.373 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=6, seq=6, startTime=2017-04-16 23:42:06.368, updateTime=2017-04-16 23:42:06.368, taskStatus=RUNNING
2017-04-16 23:42:06.373 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357326373}
2017-04-16 23:42:06.373 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":5,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-04-16 23:42:16.071 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":6,"taskType":1,"seqNo":6,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:42:16.074 [pool-1-thread-15] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=6, message={"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":6,"taskType":1,"seqNo":6,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:42:16.075 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=6, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:42:16.075 [pool-1-thread-15] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=6, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:42:16.076 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}]}
2017-04-16 23:42:16.081 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=6, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"taskId":6,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:42:16.083 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":6,"status":"SUCCEEDED"}
2017-04-16 23:42:16.084 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357326373}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}]
2017-04-16 23:42:16.084 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":1,"resultCount":"1423","seqNo":6,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":6,"status":"SUCCEEDED"}
2017-04-16 23:42:16.085 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=6, taskType=GREEN_PLUM
2017-04-16 23:42:16.085 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:42:16.085 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:42:16.085 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:42:16.085 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:42:16.085 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:42:16.086 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":5,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:42:16.091 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: , taskId=6, resultCount=1423, updateTime=2017-04-16 23:42:16.086, taskStatus=SUCCEEDED
2017-04-16 23:42:16.099 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-04-16 23:42:16.094, jobStatus=RUNNING
2017-04-16 23:42:16.101 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"QUEUEING","seqNo":6,"lastUpdateTs":1492357336100,"taskId":6,"taskStatus":"SUCCEEDED"}
2017-04-16 23:42:16.101 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SUCCEEDED","lastUpdateTs":1492357336094}
2017-04-16 23:42:16.101 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":0,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-04-16 23:42:16.102 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":6,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:42:19.437 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":7,"lastUpdateTs":1492357339434,"taskId":7,"taskStatus":"SCHEDULED"}
2017-04-16 23:42:19.437 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.MaxConcurrencySchedulingPolicy - Scheduling task selected: {"jobId":1,"taskCount":7,"jobStatus":"SCHEDULED","seqNo":7,"lastUpdateTs":1492357339434,"taskId":7,"taskStatus":"SCHEDULED"}
2017-04-16 23:42:19.437 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:42:19.437 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:42:19.437 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:42:19.438 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=1/1) 
2017-04-16 23:42:19.438 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:42:19.438 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to schedule: queue=user_job_queue, taskType=JAVA_APPLICATION,  jobId=1, taskId=7, seqNo=7, taskType=Optional[JAVA_APPLICATION], taskCount=7
2017-04-16 23:42:19.445 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=7, seqNo=7, taskStatus=SCHEDULED
2017-04-16 23:42:19.446 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SCHEDULED","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":7,"seqNo":7,"taskType":"JAVA_APPLICATION","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SCHEDULED","lastUpdateTs":1492357339445}
2017-04-16 23:42:19.448 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"jobId":1,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":7,"role":2,"seqNo":7,"taskCount":7,"params":"{\"taskDesc\":\"生成热力图数据\",\"hasIdMatch\":true,\"taskType\":2,\"handlerClass\":\"cn.shiyanjun.ddc.handler.HotMapTaskHander\",\"inputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_coordinate\",\"city\":\"北京市\",\"outputPath\":\"/user/hadoop/ddc/jmp/201610/201412361236/output/output_chart_heatmap\"}"}
2017-04-16 23:42:19.452 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Redis state changed: queue=user_job_queue, job={"jobId":1,"taskCount":7,"jobStatus":"RUNNING","seqNo":7,"lastUpdateTs":1492357339450,"taskId":7,"taskStatus":"RUNNING"}
2017-04-16 23:42:19.457 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: jobId=1, taskId=7, seq=7, startTime=2017-04-16 23:42:19.452, updateTime=2017-04-16 23:42:19.452, taskStatus=RUNNING
2017-04-16 23:42:19.458 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-memory state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}, task={"jobId":1,"taskId":7,"seqNo":7,"taskType":"JAVA_APPLICATION","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357339457}
2017-04-16 23:42:19.459 [SCHEDULED-001] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":6,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":1}
2017-04-16 23:42:26.074 [main] INFO  cn.shiyanjun.platform.scheduled.component.RabbitMQAccessService - Message published: {"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":7,"taskType":2,"seqNo":7,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:42:26.081 [pool-1-thread-16] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Message received: deliveryTag=7, message={"type":"taskProgress","platform_id":"ec39850be9184217889ba7c193af5e40","tasks":[{"jobId":1,"taskId":7,"taskType":2,"seqNo":7,"status":"SUCCEEDED","resultCount":"1423"}]}
2017-04-16 23:42:26.083 [pool-1-thread-16] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Added to rawHeartbeatMessages: deliveryTag=7, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"taskId":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:42:26.084 [SCHEDULED-002] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Dispatching fresh tasks response: deliveryTag=7, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"taskId":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:42:26.085 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Takes a fresh tasks response: {"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"taskId":7,"status":"SUCCEEDED"}]}
2017-04-16 23:42:26.086 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Prepare to handle heartbeat: deliveryTag=7, message={"platform_id":"ec39850be9184217889ba7c193af5e40","type":"taskProgress","tasks":[{"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"taskId":7,"status":"SUCCEEDED"}]}, channel=AMQChannel(amqp://dean@127.0.0.1:5672/,1)
2017-04-16 23:42:26.086 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Process task response: {"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":7,"status":"SUCCEEDED"}
2017-04-16 23:42:26.087 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Get in-memory infos: taskInfo=Optional[{"jobId":1,"taskId":7,"seqNo":7,"taskType":"JAVA_APPLICATION","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357339457}], jobInfo=Optional[{"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"RUNNING","lastUpdateTs":1492357267962}]
2017-04-16 23:42:26.087 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task succeeded: {"jobId":1,"taskType":2,"resultCount":"1423","seqNo":7,"platform_id":"ec39850be9184217889ba7c193af5e40","taskId":7,"status":"SUCCEEDED"}
2017-04-16 23:42:26.087 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - Cached recycled state: jobId=1, taskId=7, taskType=JAVA_APPLICATION
2017-04-16 23:42:26.087 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:42:26.088 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |     CONCURRENCY STATUSES 
2017-04-16 23:42:26.088 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=enterprise_job_queue: (taskType=GREEN_PLUM, occupied=0/0) (taskType=JAVA_APPLICATION, occupied=0/0) 
2017-04-16 23:42:26.088 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - |  queue=user_job_queue: (taskType=GREEN_PLUM, occupied=0/1) (taskType=JAVA_APPLICATION, occupied=0/1) 
2017-04-16 23:42:26.088 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.ResourceManagerImpl - -------------------------------------------------------------------------
2017-04-16 23:42:26.089 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":6,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
2017-04-16 23:42:26.099 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db task state changed: , taskId=7, resultCount=1423, updateTime=2017-04-16 23:42:26.089, taskStatus=SUCCEEDED
2017-04-16 23:42:26.105 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-db job state changed: jobId=1, updateTime=2017-04-16 23:42:26.1, jobStatus=SUCCEEDED
2017-04-16 23:42:26.106 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - In-memory job state changed: job={"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SUCCEEDED","lastUpdateTs":1492357346106}
2017-04-16 23:42:26.106 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - Moving in-mem job: runningJobIdToInfos -> completedJobIdToInfos
2017-04-16 23:42:26.106 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":1,"seqNo":1,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SUCCEEDED","lastUpdateTs":1492357286095}
2017-04-16 23:42:26.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":2,"seqNo":2,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SUCCEEDED","lastUpdateTs":1492357296094}
2017-04-16 23:42:26.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":3,"seqNo":3,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SUCCEEDED","lastUpdateTs":1492357306086}
2017-04-16 23:42:26.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":4,"seqNo":4,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SUCCEEDED","lastUpdateTs":1492357316093}
2017-04-16 23:42:26.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":5,"seqNo":5,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SUCCEEDED","lastUpdateTs":1492357326104}
2017-04-16 23:42:26.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":6,"seqNo":6,"taskType":"GREEN_PLUM","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"SUCCEEDED","lastUpdateTs":1492357336094}
2017-04-16 23:42:26.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem task removed: {"jobId":1,"taskId":7,"seqNo":7,"taskType":"JAVA_APPLICATION","platform_id":"ec39850be9184217889ba7c193af5e40","taskStatus":"RUNNING","lastUpdateTs":1492357339457}
2017-04-16 23:42:26.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.StateManagerImpl - In-mem job moved: {"jobId":1,"queue":"user_job_queue","taskCount":7,"jobStatus":"SUCCEEDED","lastUpdateTs":1492357346106}
2017-04-16 23:42:26.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Job counter changed: queue=user_job_queue, counter={"succeededJobCount":1,"failedJobCount":0,"timeoutJobCount":0,"cancelledJobCount":0}
2017-04-16 23:42:26.107 [SCHEDULED-004] INFO  cn.shiyanjun.platform.scheduled.component.SchedulingManagerImpl - Task counter changed: queue=user_job_queue, counter={"succeededTaskCount":7,"failedTaskCount":0,"timeoutTaskCount":0,"runningTaskCount":0}
